var Kt=Object.defineProperty,Wt=Object.defineProperties;var Qt=Object.getOwnPropertyDescriptors;var Qe=Object.getOwnPropertySymbols;var Zt=Object.prototype.hasOwnProperty,en=Object.prototype.propertyIsEnumerable;var Ze=(e,n,s)=>n in e?Kt(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,de=(e,n)=>{for(var s in n||(n={}))Zt.call(n,s)&&Ze(e,s,n[s]);if(Qe)for(var s of Qe(n))en.call(n,s)&&Ze(e,s,n[s]);return e},Ve=(e,n)=>Wt(e,Qt(n));import{C as tn,e as nn,d as sn,a as an,c as on,u as un,b as ln,E as x,f as Ne,g as $,h as z,i as De,r as B,w as W,j as ye,k as et,l as ze,m as tt,n as nt,o as st,p as at,q as pe,s as ot,t as rn,v as $e,x as m,y as C,z as d,A as g,B as c,D as oe,F as T,G as q,H as w,I as D,J as _e,K as me,L as G,M as cn,N as te,O as l,P as ue,Q as ie,R as dn,S as H,T as pn,U as le,V as he,W as Ie,X as ut,Y as fe,Z as it,_ as lt,$ as rt,a0 as _n,a1 as we,a2 as ke,a3 as ct,a4 as mn,a5 as dt,a6 as fn,a7 as gn,a8 as hn,a9 as pt,aa as En,ab as vn,ac as Fn,ad as Dn,ae as _t,af as In,ag as Cn,ah as An}from"./vendor.2c0a8b00.js";const bn=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const u of a)if(u.type==="childList")for(const o of u.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&t(o)}).observe(document,{childList:!0,subtree:!0});function s(a){const u={};return a.integrity&&(u.integrity=a.integrity),a.referrerpolicy&&(u.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?u.credentials="include":a.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function t(a){if(a.ep)return;a.ep=!0;const u=s(a);fetch(a.href,u)}};bn();const Sn="modulepreload",mt={},yn="./",ft=function(n,s){return!s||s.length===0?n():Promise.all(s.map(t=>{if(t=`${yn}${t}`,t in mt)return;mt[t]=!0;const a=t.endsWith(".css"),u=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${t}"]${u}`))return;const o=document.createElement("link");if(o.rel=a?"stylesheet":Sn,a||(o.as="script",o.crossOrigin=""),o.href=t,document.head.appendChild(o),a)return new Promise((i,r)=>{o.addEventListener("load",i),o.addEventListener("error",r)})})).then(()=>n())};var ne;(function(e){e.deleted="deleted",e.allDeleted="allDeleted",e.deleteFail="deleteFail"})(ne||(ne={}));var J;(function(e){e.autoDir="autoDir",e.newDir="newDir",e.rootDir="rootDir",e.reposDir="reposDir"})(J||(J={}));var M;(function(e){e.staticaly="staticaly",e.jsdelivr="jsdelivr",e.github="github",e.zzko="zzko"})(M||(M={}));const Le="PICX_",Ge=`${Le}CONFIG`,gt=`${Le}UPLOADED`,ht=`${Le}MANAGEMENT_MULTI`,Et=`${Le}SETTINGS`;var se;(function(e){e.uploaded="uploaded",e.allUploaded="allUploaded",e.uploadFail="uploadFail"})(se||(se={}));var ge;(function(e){e.newBranch="newBranch",e.reposBranch="reposBranch"})(ge||(ge={}));const Ce=(e,n)=>({type:"dir",dir:e,dirPath:n,childrenDirs:[],imageList:[]}),$n=e=>{if(e==="/")return{currentDir:"/",dirPath:"/"};const n=e.split("/");return n.length===1?{currentDir:"/",dirPath:"/"}:n.length>1?(n.length-=1,{currentDir:n[n.length-1],dirPath:n.join("/")}):{currentDir:"/",dirPath:"/"}},wn=e=>{if(e==="/")return[];const n=e.split("/"),s=[];let t="";return n.forEach((a,u)=>{t+=`${u>0?"/":""}${a}`,s.unshift(t)}),s};function vt(e,n,s){var t;return e?n.length===s?e:vt((t=e.childrenDirs)==null?void 0:t.find(a=>a.dir===n[s]),n,++s):null}const Ue=(e,n)=>{if(e==="/")return n;const s=e.split("/");return vt(n,s,0)},Be=(e,n,s)=>{var t;return s==="dir"?(t=n.childrenDirs)==null?void 0:t.filter(a=>a.type==="dir"):s==="image"?n.imageList.filter(a=>a.type==="image"):[]},kn=()=>{const e=localStorage.getItem(ht);return e?JSON.parse(e):Ce("/","/")},Ln={state:{name:"dirImageListModule",dirObject:kn()},mutations:{},actions:{DIR_IMAGE_LIST_ADD_DIR({state:e,dispatch:n},s){if(s==="/")return;const t=(i,r,p)=>i?(i.childrenDirs.some(_=>_.dir===r)||i.childrenDirs.push(Ce(r,p)),i.childrenDirs.find(_=>_.dir===r)||Ce(r,p)):Ce(r,p),a=s.split("/");let u="",o=e.dirObject;for(let i=0,r=a.length;i<r;i++){const p=a[i];u+=`${i>0?"/":""}${p}`,o=t(o,p,u),i===0&&n("USER_CONFIG_INFO_ADD_DIR",p)}n("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE_DIR({state:e,dispatch:n},s){if(s==="/")return;const t=(o,i,r)=>{if(i==="/")return e.dirObject;const p=o.childrenDirs.find(h=>h.dir===i);if(!p)return o;if(r){const h=o.childrenDirs.findIndex(_=>_.dir===i);h!==-1&&o.childrenDirs.splice(h,1)}return p},a=s.split("/");let u=e.dirObject;a.forEach((o,i)=>{u=t(u,o,i===a.length-1),i===0&&n("USER_CONFIG_INFO_REMOVE_DIR",o)}),n("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_IMAGE({state:e,dispatch:n},s){const t=(u,o,i,r,p=!1)=>{var _;if(!u)return e.dirObject;let h=(_=u.childrenDirs)==null?void 0:_.find(v=>v.dir===o);return h||(h={type:"dir",dir:o,dirPath:i,childrenDirs:[],imageList:[]},u.childrenDirs.push(h)),p&&!h.imageList.some(v=>v.name===r.name)&&h.imageList.push(r),h};let a=e.dirObject;if(s.dir==="/")a.imageList.some(u=>u.name===s.name)||a.imageList.push(s);else{const u=s.dir.split("/");let o="";u.forEach((i,r)=>{o+=`${r>0?"/":""}${i}`,a=t(a,i,o,s,r===u.length-1)})}n("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE({state:e,dispatch:n},s){const t=(p,h)=>{if(p.length){const _=p.findIndex(v=>v.uuid===h);_!==-1&&p.splice(_,1)}},a=(p,h,_,v)=>{if(!p)return e.dirObject;const E=p.childrenDirs.find(b=>b.dir===h);return E?(E.dir===h&&v&&t(E.imageList,_.uuid),E):e.dirObject},{dir:u,uuid:o}=s;if(u==="/"){t(e.dirObject.imageList,o),n("DIR_IMAGE_LIST_PERSIST");return}const i=u.split("/");let r=e.dirObject;i.forEach((p,h)=>{r=a(r,p,s,h===i.length-1),!r.imageList.length&&!r.childrenDirs.length&&wn(r.dirPath).forEach(v=>{const E=Ue(v,e.dirObject);if(E&&!E.imageList.length&&!E.childrenDirs.length){const{dirPath:b}=$n(v);n("SET_USER_CONFIG_INFO",{viewDir:b}),n("DIR_IMAGE_LIST_REMOVE_DIR",v)}})})},DIR_IMAGE_LIST_INIT_DIR({state:e,dispatch:n},s){let t=e.dirObject;if(s==="/"){t.imageList=[],t.childrenDirs=[],n("DIR_IMAGE_LIST_PERSIST");return}const a=(o,i,r)=>{var h;if(!o)return e.dirObject;const p=(h=o.childrenDirs)==null?void 0:h.find(_=>_.dir===i);return p?(r&&(p.imageList=[],p.childrenDirs=[]),p):e.dirObject},u=s.split("/");u.forEach((o,i)=>{t=a(t,o,i===u.length-1)}),n("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_PERSIST({state:e}){localStorage.setItem(ht,JSON.stringify(e.dirObject))},DIR_IMAGE_LOGOUT({state:e}){e.dirObject=Ce("/","/")}},getters:{getDirObject:e=>e.dirObject}},Un={state:{curImgBase64Url:"",curImgUuid:"",list:[],uploadedNumber:0},actions:{TO_UPLOAD_IMAGE_LIST_ADD({state:e},n){e.list.unshift(n)},TO_UPLOAD_IMAGE_SET_CURRENT({state:e},{uuid:n,base64Url:s}){e.curImgUuid=n,e.curImgBase64Url=s},TO_UPLOAD_IMAGE_UPLOADED({state:e}){e.uploadedNumber+=1},TO_UPLOAD_IMAGE_LIST_REMOVE({state:e},n){if(e.list.length>0){const s=e.list.findIndex(t=>t.uuid===n);if(s!==-1&&e.list.splice(s,1),e.list.length===0)e.curImgBase64Url="",e.uploadedNumber=0;else if(e.curImgUuid===n){const t=e.list[0];e.curImgBase64Url=t.imgData.base64Url,e.curImgUuid=t.uuid}}},TO_UPLOAD_IMAGE_LIST_FAIL({state:e}){if(e.list.length>0){const n=e.list.filter(s=>s.uploadStatus.progress!==100);n.length>0&&(e.list=n,e.uploadedNumber=0,e.curImgBase64Url=n[0].imgData.base64Url)}},TO_UPLOAD_IMAGE_CLEAN_URL({state:e}){e.curImgBase64Url=""},TO_UPLOAD_IMAGE_CLEAN_LIST({state:e}){e.list=[]},TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER({state:e}){e.uploadedNumber=0},TO_UPLOAD_IMAGE_LOGOUT({state:e}){e.curImgBase64Url="",e.list=[],e.uploadedNumber=0}},getters:{getToUploadImageList:e=>e.list,getToUploadImage:e=>e}},Bn=()=>{const e=sessionStorage.getItem(gt);return e?JSON.parse(e):[]},Tn={state:{uploadedImageList:Bn()},mutations:{},actions:{UPLOADED_LIST_ADD({state:e,dispatch:n},s){e.uploadedImageList.unshift(s),n("UPLOADED_LIST_PERSIST")},UPLOADED_LIST_REMOVE({state:e,dispatch:n},s){if(e.uploadedImageList.length>0){const t=e.uploadedImageList.findIndex(a=>a.uuid===s);t!==-1&&(e.uploadedImageList.splice(t,1),n("UPLOADED_LIST_PERSIST"))}},UPLOADED_LIST_PERSIST({state:e}){sessionStorage.setItem(gt,JSON.stringify(e.uploadedImageList))},UPLOADED_LIST_LOGOUT({state:e}){e.uploadedImageList=[]}},getters:{getUploadedImageList:e=>e.uploadedImageList}},Ft=e=>{const n=Object.prototype.toString.call(e).split(" ")[1];return n.substring(0,n.length-1).toLowerCase()},Dt=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),On=e=>{const n=window.localStorage.getItem(e);return n?JSON.parse(n):null},It=e=>{for(const n in e)switch(Ft(e[n])){case"object":It(e[n]);break;case"string":e[n]="";break;case"array":e[n]=[];break;case"number":e[n]=0;break;case"boolean":e[n]=!1;break}},je=(e,n)=>{for(const s in n)Ft(n[s])!=="object"?e&&(e[s]=n[s]):je(e[s],n[s])};class He{static zerofill(n){return n<10?`0${n}`:n}static getYyyyMmDd(n=Date.now()){const s=new Date(n),t=s.getFullYear(),a=s.getMonth()+1,u=s.getDate();return`${t}${this.zerofill(a)}${this.zerofill(u)}`}static formatTimestamp(n=Date.now()){const s=new Date(n),t=s.getFullYear(),a=s.getMonth()+1,u=s.getDate(),o=s.getHours(),i=s.getMinutes(),r=s.getSeconds();return`${t}-${this.zerofill(a)}-${this.zerofill(u)} ${this.zerofill(o)}:${this.zerofill(i)}:${this.zerofill(r)}`}}const Ct=()=>{const e={token:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepos:"",reposList:[],branchMode:ge.reposBranch,branchList:[],selectedBranch:"",selectedDir:"",dirMode:J.reposDir,dirList:[],loggingStatus:!1,selectedDirList:[],viewDir:""},n=localStorage.getItem(Ge);return n&&(je(e,JSON.parse(n)),e.selectedBranch&&!e.branchList.length&&(e.branchList=[{value:e.selectedBranch,label:e.selectedBranch}]),e.dirMode===J.autoDir&&(e.selectedDir=He.getYyyyMmDd())),e},Mn=e=>{const{selectedDir:n,selectedBranch:s,dirMode:t}=e.userConfigInfo;if(t==="newDir"){const a=n.split("");let u=0,o="";for(let i=0;i<a.length&&((a[i]===" "||a[i]==="."||a[i]==="\u3001")&&(a[i]="-"),a[i]==="/"&&(u+=1),!(u>=3));i++)o+=a[i];e.userConfigInfo.selectedDir=o}e.userConfigInfo.selectedBranch=s.replace(/\s+/g,"-")},xn={state:{userConfigInfo:Ct()},actions:{USER_CONFIG_INFO_RESET({state:e}){e.userConfigInfo=Ct()},SET_USER_CONFIG_INFO({state:e,dispatch:n},s){for(const t in s)e.userConfigInfo.hasOwnProperty(t)&&(e.userConfigInfo[t]=s[t]);n("USER_CONFIG_INFO_PERSIST")},USER_CONFIG_INFO_ADD_DIR({state:e,dispatch:n},s){e.userConfigInfo.dirList.some(t=>t.value===s)||(e.userConfigInfo.dirList.push({label:s,value:s}),n("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR({state:e,dispatch:n},s){const{dirList:t}=e.userConfigInfo;if(t.some(a=>a.value===s)){const a=t.findIndex(u=>u.value===s);t.splice(a,1),n("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST({state:e}){Mn(e),localStorage.setItem(Ge,JSON.stringify(e.userConfigInfo))},USER_CONFIG_INFO_LOGOUT({state:e}){It(e.userConfigInfo)}},getters:{getUserLoggingStatus:e=>e.userConfigInfo.loggingStatus,getUserConfigInfo:e=>e.userConfigInfo}},Rn={state:{imageViewer:{imgInfo:null,isShow:!1}},mutations:{IMAGE_VIEWER(e,{imgInfo:n,isShow:s}){e.imageViewer.imgInfo=n,e.imageViewer.isShow=s},IMAGE_VIEWER_LOGOUT(e){e.imageViewer.isShow=!1,e.imageViewer.imgInfo=null}},actions:{},getters:{getImageViewer:e=>e.imageViewer}},Pn={state:{imgCardArr:[]},mutations:{IMAGE_CARD(e,{imageObj:n}){const{uuid:s,checked:t}=n;t&&e.imgCardArr.forEach(a=>{a.uuid===s&&(a.checked=!0)})},REPLACE_IMAGE_CARD(e,{checkedImgArr:n}){n.length>0?e.imgCardArr=n:e.imgCardArr=[]}},actions:{},getters:{getImageCardArr:e=>e.imgCardArr,getImageCardCheckedArr:e=>e.imgCardArr.filter(n=>n.checked)}},Vn={state:{uploadAreaActive:!1},mutations:{CHANGE_UPLOAD_AREA_ACTIVE(e,n){e.uploadAreaActive=n},UPLOAD_AREA_ACTIVE_LOGOUT(e){e.uploadAreaActive=!1}},actions:{},getters:{getUploadAreaActive:e=>e.uploadAreaActive}},Nn={state:{uploadSettings:{isSetMaxSize:!0,imageMaxSize:30*1024}},mutations:{UPLOAD_SETTINGS_LOGOUT(e){e.uploadSettings.isSetMaxSize=!0,e.uploadSettings.imageMaxSize=50*1024}},actions:{},getters:{getUploadSettings:e=>e.uploadSettings}};var Te;(function(e){e.mozJPEG="mozJPEG",e.avif="avif",e.webP="webP"})(Te||(Te={}));const zn=async(e,n)=>new tn(e,{encoderState:{type:n,options:nn[n].meta.defaultOptions},processorState:sn,preprocessorState:an}).process(),Xe={defaultHash:!0,defaultMarkdown:!1,defaultPrefix:!1,prefixName:"",isCompress:!0,compressEncoder:Te.webP,themeMode:"light",autoLightThemeTime:["08:00","19:00"],elementPlusSize:"default",externalLinkType:M.staticaly},Gn=()=>{const e=On(Et);return e&&je(Xe,e),Xe},jn={state:{userSettings:Gn()},actions:{SET_USER_SETTINGS({state:e},n){for(const s in n)e.userSettings.hasOwnProperty(s)&&(e.userSettings[s]=n[s])},USER_SETTINGS_PERSIST({state:e}){localStorage.setItem(Et,JSON.stringify(e.userSettings))},USER_SETTINGS_LOGOUT({state:e}){e.userSettings=Xe}},getters:{getUserSettings:e=>e.userSettings}},R=on({modules:{dirImageListModule:Ln,toUploadImageModule:Un,uploadedImageListModule:Tn,userConfigInfoModule:xn,imageViewerModule:Rn,imageCardModule:Pn,uploadAreaActiveModule:Vn,uploadSettingsModule:Nn,userSettingsModule:jn},state:{rootName:"root"},mutations:{},actions:{LOGOUT({dispatch:e,commit:n}){e("DIR_IMAGE_LOGOUT"),e("TO_UPLOAD_IMAGE_LOGOUT"),e("UPLOADED_LIST_LOGOUT"),e("USER_CONFIG_INFO_LOGOUT"),n("IMAGE_VIEWER_LOGOUT"),n("UPLOAD_AREA_ACTIVE_LOGOUT"),n("UPLOAD_SETTINGS_LOGOUT"),e("USER_SETTINGS_LOGOUT"),localStorage.clear(),sessionStorage.clear()}},getters:{}}),At=Symbol("vuex-store");function X(){return un(At)}const Hn="https://api.github.com",P=ln.create({baseURL:Hn,timeout:3e5});P.defaults.headers["Content-Type"]="application/json";P.interceptors.request.use(e=>{const n=localStorage.getItem(Ge);if(n){const{token:s}=JSON.parse(n);s&&(e.headers.Authorization=`token ${s}`)}return e},e=>Promise.reject(e));P.interceptors.response.use(e=>e,e=>{if(e.response&&e.response.data){const n=e.response.status,s=e.response.data.message;x.error(`Code: ${n}, Message: ${s}`),console.error("[PicX Error]",e.response)}else x.error(`${e}`);return e.response});async function Xn(e){const{owner:n,selectedRepos:s,selectedBranch:t}=e,a=Ne.service({text:"\u6B63\u5728\u521D\u59CB\u5316\u4ED3\u5E93..."}),u=await P.put(`/repos/${n}/${s}/contents/README.md`,{message:"Init repos via PicX(https://github.com/XPoet/picx)",branch:t,content:window.btoa(`
# Welcome to use PicX

[PicX](https://github.com/XPoet/picx) is a simple and powerful image hosting tool. It supports image hosting services via GitHub repository.

PicX is completely open source, and you can use it for free.

If you like it, please give it a star on [GitHub](https://github.com/XPoet/picx).

Thank you for your support!
        `)});(u==null?void 0:u.status)===201?a.close():x.error("\u4ED3\u5E93\u521D\u59CB\u5316\u5931\u8D25")}const Oe=e=>{const n=e.indexOf(".");return e.substr(0,n).trim().replace(/\s+/g,"-")},Ye=e=>{const n=e.lastIndexOf(".");return e.substr(n+1,e.length)},bt=e=>/(png|jpg|gif|jpeg|webp|avif|svg\+xml|image\/x-icon)$/.test(e),Je=e=>Number((e/1024).toFixed(2)),St=e=>e?{name:Oe(e),hash:Dt(),suffix:Ye(e)}:{name:"",hash:"",suffix:""},yt=()=>{let e=document.querySelector(".temp-external-link-txt");return e||(e=document.createElement("textarea"),e.setAttribute("class","temp-external-link-txt"),e.style.position="absolute",e.style.top="-99999rem",e.style.left="-99999rem",document.body.appendChild(e)),e},re=(e,n,s)=>{const{owner:t,selectedRepos:a,selectedBranch:u}=s,o=`https://cdn.staticaly.com/gh/${t}/${a}@${u}/${n}`,i=`https://jsd.cdn.zzko.cn/gh/${t}/${a}@${u}/${n}`,r=`https://cdn.jsdelivr.net/gh/${t}/${a}@${u}/${n}`,p=`https://github.com/${t}/${a}/raw/${u}/${n}`;switch(e){case M.staticaly:return o;case M.zzko:return i;case M.jsdelivr:return r;case M.github:return p;default:return p}},ce=(e,n)=>`![${Oe(e)}](${n})`,Yn=(e,n)=>{let s="",t="";const{name:a,is_transform_md:u}=e;switch(n){case M.jsdelivr:u?(s=ce(a,e.jsdelivr_cdn_url),t="Markdown \u683C\u5F0F\u7684 jsDelivr CDN"):(s=e.jsdelivr_cdn_url,t="jsDelivr CDN");break;case M.staticaly:u?(s=ce(a,e.staticaly_cdn_url),t="Markdown \u683C\u5F0F\u7684 Staticaly CDN"):(s=e.staticaly_cdn_url,t="Staticaly CDN");break;case M.zzko:u?(s=ce(a,e.zzko_cdn_url),t="Markdown \u683C\u5F0F\u7684 zzko CDN"):(s=e.zzko_cdn_url,t="zzko CDN");break;default:u?(s=ce(a,e.github_url),t="Markdown \u683C\u5F0F\u7684 GitHub"):(s=e.github_url,t="GitHub")}const o=yt();o.value=s,o.select(),document.execCommand("copy"),x.success(`${t} \u5916\u94FE\u590D\u5236\u6210\u529F\uFF01`)},Jn=(e,n)=>{let s="";const t=yt();t.value="",(e==null?void 0:e.length)>0?(e.forEach((a,u)=>{const o=a.is_transform_md;switch(n){case M.jsdelivr:s=o?ce(a.name,a.jsdelivr_cdn_url):a.jsdelivr_cdn_url;break;case M.staticaly:s=o?ce(a.name,a.staticaly_cdn_url):a.staticaly_cdn_url;break;case M.zzko:s=o?ce(a.name,a.zzko_cdn_url):a.zzko_cdn_url;break;default:s=o?ce(a.name,a.github_url):a.github_url}u<e.length-1?t.value+=s+`
`:t.value+=s}),t.select(),document.execCommand("copy"),x.success("\u6279\u91CF\u590D\u5236\u56FE\u7247\u94FE\u63A5\u6210\u529F")):console.warn("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")},Me=$(()=>R.getters.getUserConfigInfo).value;function qn(e,n){return{type:"image",uuid:Dt(),dir:n,name:e.name,sha:e.sha,path:e.path,deleting:!1,is_transform_md:!1,size:e.size,checked:!1,github_url:re(M.github,e.path,Me),jsdelivr_cdn_url:re(M.jsdelivr,e.path,Me),staticaly_cdn_url:re(M.staticaly,e.path,Me),zzko_cdn_url:re(M.zzko,e.path,Me)}}const Ee=$(()=>R.getters.getUserConfigInfo).value,$t=(e="")=>new Promise(n=>{P.get(`/repos/${Ee.owner}/${Ee.selectedRepos}/contents/${e}`,{params:{ref:Ee.selectedBranch}}).then(s=>{s&&s.status===200&&s.data.length>0?n(s.data.filter(t=>t.type==="dir").map(t=>({value:t.name,label:t.name}))):n(null)}).catch(()=>{n(null)})}),xe=(e="")=>new Promise(n=>{P.get(`/repos/${Ee.owner}/${Ee.selectedRepos}/contents/${e}`,{params:{ref:Ee.selectedBranch}}).then(s=>{s&&s.status===200&&s.data.length?(s.data.filter(t=>t.type==="dir").forEach(t=>R.dispatch("DIR_IMAGE_LIST_ADD_DIR",t.path)),setTimeout(()=>{s.data.filter(t=>t.type==="file"&&bt(Ye(t.name))).forEach(t=>{R.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",qn(t,e))})},100),n(!0)):n(null)}).catch(()=>{n(null)})});var j=(e,n)=>{const s=e.__vccOpts||e;for(const[t,a]of n)s[t]=a;return s};const Kn={class:"page-container config-page-container"},Wn=z({__name:"config",setup(e){const n=De(),s=X(),t=$(()=>s.getters.getUserConfigInfo).value,a=$(()=>s.getters.getUserConfigInfo).value,u=$(()=>s.getters.getUserSettings).value,o=B(!1),i=B(!1),r=B(!1),p=$(()=>u.elementPlusSize==="large"?"right":"top"),h=B("elCascaderKey");function _(){s.dispatch("USER_CONFIG_INFO_PERSIST")}function v(y){t.loggingStatus=!0,t.owner=y.data.login,t.name=y.data.name,t.email=y.data.email,t.avatarUrl=y.data.avatar_url,_()}function E(y){P.get(y,{params:{type:"public",sort:"created",per_page:100}}).then(F=>{if(console.log("[getReposList] ",F),F.status===200&&F.data.length>0){t.reposList=[];for(const L of F.data)!L.fork&&!L.private&&t.reposList.push({value:L.name,label:L.name,desc:L.description});o.value=!1,_()}})}async function b(){i.value=!0,t.dirList=await $t(),_(),i.value=!1}function S(y){switch(y){case J.rootDir:t.selectedDir="/";break;case J.autoDir:t.selectedDir=He.getYyyyMmDd();break;case J.newDir:t.selectedDir="xxx";break;case J.reposDir:const{dirList:F}=t;F.length?t.selectedDir=F[0].value:t.selectedDir="";break;default:t.selectedDir="/";break}_()}function f(y){r.value=!0,P.get(`/repos/${t.owner}/${y}/branches`).then(async F=>{if(console.log("getBranchList >> ",F),F&&F.status===200){if(r.value=!1,F.data.length>0){for(const L of F.data)t.branchList.push({value:L.name,label:L.name});t.branchList.reverse(),t.selectedBranch=t.branchList[0].value,t.branchMode=ge.reposBranch,b()}else t.selectedBranch="master",t.branchMode=ge.newBranch,await Xn(t);S(t.dirMode),_()}})}function A(){t.token?(o.value=!0,P.get("/user",{headers:{Authorization:`token ${t.token}`}}).then(y=>{console.log("[getUserInfo] ",y),y&&y.status===200?(v(y),E(y.data.repos_url)):o.value=!1})):x.warning("Token \u4E0D\u80FD\u4E3A\u7A7A\uFF01")}function I(y){t.branchList=[],t.dirList=[],f(y),_()}async function N(y){t.selectedBranch=y,await b(),h.value=t.selectedBranch,t.selectedDir=t.dirList[0].value,t.selectedDirList=[t.selectedDir],_()}function ae(y){const F=t.selectedBranch,L=t.branchList[0].value;switch(y){case ge.newBranch:t.selectedBranch="xxx",t.dirMode=J.newDir,t.selectedDir="xxx";break;case ge.reposBranch:F!==L&&(t.selectedBranch=L,b());break;default:t.selectedBranch="";break}_()}function k(){o.value=!1,i.value=!1,s.dispatch("LOGOUT")}async function O(){const{selectedDir:y,dirMode:F}=t;let L="\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01";if(y===""){switch(F){case J.newDir:L="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break;case J.reposDir:L=`\u8BF7\u9009\u62E9 ${t.selectedRepos} \u4ED3\u5E93\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55\uFF01`;break;default:L="\u8BF7\u5728\u8F93\u5165\u6846\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\uFF01";break}x.warning(L)}else await n.push("/upload")}const Y={lazy:!0,checkStrictly:!0,async lazyLoad(y,F){const{level:L,pathLabels:V}=y;let Q;L===0?Q=t.dirList:Q=await $t(V.join("/")),F(Q?Q.map(Z=>({value:Z.value,label:Z.label,leaf:L>=2})):[])}};function K(y){t.selectedDirList=y,t.selectedDir=y.join("/"),_()}return W(()=>a,y=>{y||(o.value=!1,i.value=!1)}),(y,F)=>{const L=ye,V=et,Q=ze,Z=tt,Ae=nt,ee=st,be=at,Se=pe,Jt=ot,qt=rn,Re=$e;return m(),C("div",Kn,[d(Z,{"label-width":"70rem","label-position":c(p),class:"config-form"},{default:g(()=>[d(V,{label:"Token"},{default:g(()=>[d(L,{modelValue:c(t).token,"onUpdate:modelValue":F[0]||(F[0]=U=>c(t).token=U),clearable:"",autofocus:!c(t).token,type:"password","show-password":"",placeholder:"\u8BF7\u8F93\u5165 GitHub Token"},null,8,["modelValue","autofocus"])]),_:1}),d(V,{class:"operation"},{default:g(()=>[d(Q,{plain:"",type:"primary","native-type":"submit",onClick:F[1]||(F[1]=oe(U=>A(),["prevent"]))},{default:g(()=>[T(" \u786E\u8BA4 Token ")]),_:1})]),_:1})]),_:1},8,["label-position"]),c(t).token?q((m(),w(Z,{key:0,"label-width":"70rem","label-position":c(p),"element-loading-text":"\u52A0\u8F7D\u4E2D..."},{default:g(()=>[c(t).owner?(m(),w(V,{key:0,label:"\u7528\u6237\u540D"},{default:g(()=>[d(L,{modelValue:c(t).owner,"onUpdate:modelValue":F[2]||(F[2]=U=>c(t).owner=U),readonly:""},null,8,["modelValue"])]),_:1})):D("",!0),c(t).email?(m(),w(V,{key:1,label:"\u90AE\u7BB1"},{default:g(()=>[d(L,{modelValue:c(t).email,"onUpdate:modelValue":F[3]||(F[3]=U=>c(t).email=U),readonly:""},null,8,["modelValue"])]),_:1})):D("",!0),c(t).reposList.length?(m(),w(V,{key:2,label:"\u9009\u62E9\u4ED3\u5E93"},{default:g(()=>[d(ee,{modelValue:c(t).selectedRepos,"onUpdate:modelValue":F[4]||(F[4]=U=>c(t).selectedRepos=U),filterable:"",style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u56FE\u5E8A\u4ED3\u5E93...",onChange:I},{default:g(()=>[(m(!0),C(_e,null,me(c(t).reposList,(U,Pe)=>(m(),w(Ae,{key:Pe,label:U.label,value:U.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):D("",!0)]),_:1},8,["label-position"])),[[Re,o.value]]):D("",!0),c(t).selectedRepos&&c(t).branchList.length?q((m(),w(Z,{key:1,"label-width":"70rem","label-position":c(p),"element-loading-text":"\u52A0\u8F7D\u4E2D..."},{default:g(()=>[(c(t).selectedRepos,D("",!0)),c(t).branchList.length>1&&c(t).branchMode==="reposBranch"?(m(),w(V,{key:1,label:"\u9009\u62E9\u5206\u652F"},{default:g(()=>[d(ee,{modelValue:c(t).selectedBranch,"onUpdate:modelValue":F[6]||(F[6]=U=>c(t).selectedBranch=U),filterable:"",style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u5206\u652F...",onChange:N},{default:g(()=>[(m(!0),C(_e,null,me(c(t).branchList,(U,Pe)=>(m(),w(Ae,{key:Pe,label:U.label,value:U.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):D("",!0),c(t).branchMode==="newBranch"?(m(),w(V,{key:2,label:"\u65B0\u5EFA\u5206\u652F"},{default:g(()=>[d(L,{modelValue:c(t).selectedBranch,"onUpdate:modelValue":F[7]||(F[7]=U=>c(t).selectedBranch=U),onInput:F[8]||(F[8]=U=>_()),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u5206\u652F..."},null,8,["modelValue"])]),_:1})):D("",!0)]),_:1},8,["label-position"])),[[Re,r.value]]):D("",!0),c(t).selectedBranch?q((m(),w(Z,{key:2,"label-width":"70rem","label-position":c(p),"element-loading-text":"\u52A0\u8F7D\u4E2D..."},{default:g(()=>[c(t).selectedBranch?(m(),w(V,{key:0,label:"\u76EE\u5F55\u65B9\u5F0F"},{default:g(()=>[d(Jt,{modelValue:c(t).dirMode,"onUpdate:modelValue":F[9]||(F[9]=U=>c(t).dirMode=U),onChange:S},{default:g(()=>[d(Se,{content:"\u624B\u52A8\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55",placement:"top",offset:-1},{default:g(()=>[d(be,{label:"newDir"},{default:g(()=>[T("\u65B0\u5EFA\u76EE\u5F55")]),_:1})]),_:1}),d(Se,{content:"\u56FE\u7247\u5B58\u50A8\u5728 "+c(t).selectedBranch+" \u5206\u652F\u7684\u6839\u76EE\u5F55\u4E0B",placement:"top",offset:-1},{default:g(()=>[d(be,{label:"rootDir"},{default:g(()=>[T("\u6839\u76EE\u5F55")]),_:1})]),_:1},8,["content"]),d(Se,{content:"\u6839\u636E\u65E5\u671F\u81EA\u52A8\u521B\u5EFA\u683C\u5F0F YYYYMMDD \u7684\u76EE\u5F55",placement:"top",offset:-1},{default:g(()=>[d(be,{label:"autoDir"},{default:g(()=>[T("\u81EA\u52A8\u76EE\u5F55")]),_:1})]),_:1}),c(t).dirList.length&&c(t).branchMode!=="newBranch"?(m(),w(Se,{key:0,content:"\u9009\u62E9 "+c(t).selectedBranch+" \u5206\u652F\u4E0B\u7684\u4E00\u4E2A\u76EE\u5F55",placement:"top",offset:-1},{default:g(()=>[d(be,{label:"reposDir"},{default:g(()=>[T(" \u9009\u62E9 "+G(c(t).selectedRepos)+" \u4ED3\u5E93\u76EE\u5F55 ",1)]),_:1})]),_:1},8,["content"])):D("",!0)]),_:1},8,["modelValue"])]),_:1})):D("",!0),c(t).dirMode==="autoDir"?(m(),w(V,{key:1,label:"\u81EA\u52A8\u76EE\u5F55"},{default:g(()=>[d(L,{modelValue:c(t).selectedDir,"onUpdate:modelValue":F[10]||(F[10]=U=>c(t).selectedDir=U),readonly:""},null,8,["modelValue"])]),_:1})):D("",!0),c(t).dirMode==="rootDir"?(m(),w(V,{key:2,label:"\u6839\u76EE\u5F55"},{default:g(()=>[d(L,{modelValue:c(t).selectedDir,"onUpdate:modelValue":F[11]||(F[11]=U=>c(t).selectedDir=U),readonly:""},null,8,["modelValue"])]),_:1})):D("",!0),c(t).dirMode==="newDir"?(m(),w(V,{key:3,label:"\u65B0\u5EFA\u76EE\u5F55"},{default:g(()=>[d(L,{modelValue:c(t).selectedDir,"onUpdate:modelValue":F[12]||(F[12]=U=>c(t).selectedDir=U),onInput:F[13]||(F[13]=U=>_()),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5EFA\u7684\u76EE\u5F55..."},null,8,["modelValue"])]),_:1})):D("",!0),c(t).dirList.length&&c(t).dirMode==="reposDir"&&c(t).branchMode!=="newBranch"?(m(),w(V,{key:4,label:"\u9009\u62E9\u76EE\u5F55"},{default:g(()=>[(m(),w(qt,{style:{width:"100%"},props:Y,key:h.value,modelValue:c(t).selectedDirList,"onUpdate:modelValue":F[14]||(F[14]=U=>c(t).selectedDirList=U),filterable:"",placeholder:"\u8BF7\u9009\u62E9\u4E00\u4E2A\u76EE\u5F55...",clearable:"",onChange:K},null,8,["modelValue"]))]),_:1})):D("",!0)]),_:1},8,["label-position"])),[[Re,i.value]]):D("",!0),d(Z,{"label-width":"70rem","label-position":c(p)},{default:g(()=>[d(V,{class:"operation"},{default:g(()=>[c(t).owner?(m(),w(Q,{key:0,plain:"",type:"warning",onClick:F[15]||(F[15]=U=>k())},{default:g(()=>[T(" \u91CD\u7F6E ")]),_:1})):D("",!0),c(t).selectedRepos?(m(),w(Q,{key:1,plain:"",type:"success",onClick:O},{default:g(()=>[T(" \u5B8C\u6210\u914D\u7F6E ")]),_:1})):D("",!0)]),_:1})]),_:1},8,["label-position"])])}}});var Qn=j(Wn,[["__scopeId","data-v-5fbe9c9a"]]);const wt=e=>(ue("data-v-439af088"),e=e(),ie(),e),Zn={class:"copy-external-link-box"},es={key:0,t:"1631782798077",class:"markdown-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2861",width:"26",height:"26"},ts=wt(()=>l("path",{d:"M92 192C42.24 192 0 232.128 0 282.016v459.968C0 791.904 42.24 832 92 832h840C981.76 832 1024 791.872 1024 741.984V282.016C1024 232.16 981.76 192 932 192z m0 64h840c16.512 0 28 12.256 28 26.016v459.968c0 13.76-11.52 26.016-28 26.016H92C75.488 768 64 755.744 64 741.984V282.016c0-13.76 11.52-25.984 28-25.984zM160 352v320h96v-212.992l96 127.008 96-127.04V672h96V352h-96l-96 128-96-128z m544 0v160h-96l144 160 144-160h-96v-160z","p-id":"2862",fill:"#808080"},null,-1)),ns=[ts],ss={key:1,t:"1631784688556",class:"markdown-icon active",viewBox:"0 0 1280 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3242",width:"26",height:"26"},as=wt(()=>l("path",{d:"M1187.6 118.2H92.4C41.4 118.2 0 159.6 0 210.4v603c0 51 41.4 92.4 92.4 92.4h1095.4c51 0 92.4-41.4 92.2-92.2V210.4c0-50.8-41.4-92.2-92.4-92.2zM677 721.2H554v-240l-123 153.8-123-153.8v240H184.6V302.8h123l123 153.8 123-153.8h123v418.4z m270.6 6.2L763 512H886V302.8h123V512H1132z","p-id":"3243",fill:"#3c3c3c"},null,-1)),os=[as],us={class:"btn-box"},is=z({__name:"copy-external-link",props:{imgObj:{type:Object,default:()=>{}}},setup(e){const n=e,s=$(()=>R.getters.getUserSettings).value;let t=B(n.imgObj).value;const a=M,u=o=>{Yn(t,o)};return cn(()=>{t=n.imgObj}),te(()=>{t.is_transform_md=s.defaultMarkdown}),W(()=>s.defaultMarkdown,o=>{t.is_transform_md=o}),(o,i)=>{const r=pe;return m(),C("div",Zn,[l("div",null,[d(r,{content:c(t).is_transform_md?"\u70B9\u51FB\u8F6C\u6362\u666E\u901A\u5916\u94FE":"\u70B9\u51FB\u8F6C\u6362 Markdown \u683C\u5F0F\u5916\u94FE",placement:"top"},{default:g(()=>[l("div",{class:"markdown-icon-box flex-center",onClick:i[0]||(i[0]=p=>c(t).is_transform_md=!c(t).is_transform_md)},[c(t).is_transform_md?D("",!0):(m(),C("svg",es,ns)),c(t).is_transform_md?(m(),C("svg",ss,os)):D("",!0)])]),_:1},8,["content"])]),l("div",us,[d(r,{content:"\u70B9\u51FB\u590D\u5236 Staticaly CDN \u5916\u94FE",placement:"top"},{default:g(()=>[l("span",{class:"btn-item copy-url flex-center",onClick:i[1]||(i[1]=p=>u(c(a).staticaly))}," Staticaly ")]),_:1}),d(r,{content:"\u70B9\u51FB\u590D\u5236 zzko CDN \u5916\u94FE",placement:"top"},{default:g(()=>[l("span",{class:"btn-item copy-url flex-center",onClick:i[2]||(i[2]=p=>u(c(a).zzko))}," zzko ")]),_:1})])])}}});var qe=j(is,[["__scopeId","data-v-439af088"]]),kt=()=>({uuid:"",uploadStatus:{progress:0,uploading:!1},imgData:{base64Content:"",base64Url:""},fileInfo:{size:0,lastModified:0},filename:{name:"",hash:"",suffix:"",prefixName:"",now:"",initName:"",newName:"xxx",isHashRename:!0,isRename:!1,isPrefix:!1},externalLink:{github:"",jsdelivr:"",staticaly:"",zzko:""}});function ls(e,n){const s=document.createElement("canvas"),t=s.getContext("2d"),a=new Image;return a.crossOrigin="Anonymous",a.src=e,new Promise(u=>{a.onload=()=>{const{width:o}=a,{height:i}=a;s.width=o,s.height=i,t==null||t.drawImage(a,0,0,o,i);const r=s.toDataURL(`image/${n}`);u(r)}})}function rs(e,n){const s=$(()=>R.getters.getUserSettings).value,t=kt();t.imgData.base64Url=e,t.imgData.base64Content=e.split(",")[1];const{name:a,hash:u,suffix:o}=St(n.name);return t.uuid=u,t.fileInfo.size=n.size,t.fileInfo.originSize=n.size,t.fileInfo.lastModified=n.lastModified,t.filename.name=a,t.filename.hash=u,t.filename.suffix=o,t.filename.now=s.defaultHash?`${a}.${u}.${o}`:`${a}.${o}`,t.filename.initName=a,t.filename.isHashRename=s.defaultHash,t}const Lt=(e,n,s)=>{const t=R.getters.getUserSettings;n.uploadStatus.progress=100,n.uploadStatus.uploading=!1,n.externalLink.github=re(M.github,e.path,s),n.externalLink.jsdelivr=re(M.jsdelivr,e.path,s),n.externalLink.staticaly=re(M.staticaly,e.path,s),n.externalLink.zzko=re(M.zzko,e.path,s);const a={checked:!1,type:"image",uuid:n.uuid,dir:s.selectedDir,name:e.name,sha:e.sha,path:e.path,is_transform_md:t.defaultMarkdown,deleting:!1,size:n.fileInfo.size,github_url:n.externalLink.github,jsdelivr_cdn_url:n.externalLink.jsdelivr,staticaly_cdn_url:n.externalLink.staticaly,zzko_cdn_url:n.externalLink.zzko};n.uploadedImg=a,R.dispatch("UPLOADED_LIST_ADD",a),R.dispatch("DIR_IMAGE_LIST_ADD_DIR",s.selectedDir),R.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",a)},cs=(e,n)=>{let s="";return e.selectedDir!=="/"&&(s=`${e.selectedDir}/`),`/repos/${e.owner}/${e.selectedRepos}/contents/${s}${n}`};async function ds(e,n){var E,b,S,f;const{selectedBranch:s,selectedRepos:t,selectedDir:a,dirMode:u,owner:o}=e;n.forEach(A=>{A.uploadStatus.uploading=!0});let i=await Promise.all(n.map(A=>P.post(`/repos/${o}/${t}/git/blobs`,{owner:o,repo:t,content:A.imgData.base64Content,encoding:"base64"}).then(I=>(I&&I.status===201?R.dispatch("TO_UPLOAD_IMAGE_UPLOADED",A.uuid):(A.uploadStatus.uploading=!1,x.error(`${A.filename.now} \u4E0A\u4F20\u5931\u8D25`)),de({img:A},I)))));const r=await P.get(`/repos/${o}/${t}/branches/${s}`);if((r==null?void 0:r.status)!==200)throw new Error("\u83B7\u53D6\u5206\u652F\u4FE1\u606F\u5931\u8D25");i=i.filter(A=>A.status===201);const p=a==="/"?"":`${a}/`,h=await P.post(`/repos/${o}/${t}/git/trees`,{tree:i.map(A=>({path:`${p}${A.img.filename.now}`,mode:"100644",type:"blob",sha:A.data.sha})),base_tree:((f=(S=(b=(E=r.data)==null?void 0:E.commit)==null?void 0:b.commit)==null?void 0:S.tree)==null?void 0:f.sha)||null});if((h==null?void 0:h.status)!==201)throw new Error("\u521B\u5EFA tree \u5931\u8D25");const _=await P.post(`/repos/${o}/${t}/git/commits`,{tree:h.data.sha,parents:[r.data.commit.sha],message:"Upload images via PicX(https://github.com/XPoet/picx)"});if((_==null?void 0:_.status)!==201)throw new Error("\u521B\u5EFA commit \u5931\u8D25");const v=await P.patch(`/repos/${o}/${t}/git/refs/heads/${s}`,{sha:_.data.sha});if((v==null?void 0:v.status)!==200)throw new Error("\u66F4\u65B0 ref \u5931\u8D25");i.forEach(A=>{const I=A.img.filename.now;Lt({name:I,sha:A.data.sha,path:`${p}${I}`},A.img,e)})}function Ut(e,n){const{selectedBranch:s,email:t,owner:a}=e;n.uploadStatus.uploading=!0;const u={message:"Upload image via PicX(https://github.com/XPoet/picx)",branch:s,content:n.imgData.base64Content};return t&&(u.committer={name:a,email:t}),new Promise((o,i)=>{P.put(cs(e,n.filename.now),u).then(r=>{r&&r.status===201?(Lt({name:r.data.name,sha:r.data.sha,path:r.data.path},n,e),R.dispatch("TO_UPLOAD_IMAGE_UPLOADED",n.uuid),o(!0)):(n.uploadStatus.uploading=!1,o(!1))}).catch(r=>{i(r)})})}const ps={class:"image-box"},_s=["src"],ms={class:"info-box"},fs={class:"image-info"},gs={key:1,class:"filename"},hs={class:"image-operation"},Es={class:"operation-box"},vs={class:"operation-left"},Fs={class:"operation-right"},Ds={class:"operation-btn"},Is=z({__name:"image-card",props:{listing:{type:Boolean,default:!1},imageObj:{type:Object,default:()=>{}},isUploaded:{type:Boolean,default:!1},index:{type:Number},modelValue:{type:Number}},emits:["update:modelValue"],setup(e,{emit:n}){const s=e,t=X(),a=dn(),u=$(()=>t.getters.getUserConfigInfo).value,o=$(()=>t.getters.getUserSettings).value,i=$(()=>a.path==="/management"),r=$(()=>{switch(o.externalLinkType){case M.jsdelivr:return s.imageObj.jsdelivr_cdn_url;case M.staticaly:return s.imageObj.staticaly_cdn_url;case M.zzko:return s.imageObj.zzko_cdn_url;default:return s.imageObj.github_url}}),p=B(),h=B(!1),_=B(""),v=B(!1),E=(k,O=!1)=>{O||(k.deleting=!0);const{owner:Y,selectedRepos:K}=u;return new Promise(y=>{P.delete(`/repos/${Y}/${K}/contents/${k.path}`,{data:{owner:Y,repo:K,path:k.path,message:"Delete pictures via PicX (https://github.com/XPoet/picx)",sha:k.sha}}).then(F=>{console.log("deleteImage >> ",F),F&&F.status===200?(k.deleting=!1,x.success(`${O?"\u66F4\u65B0":"\u5220\u9664"}\u6210\u529F\uFF01`),t.dispatch("UPLOADED_LIST_REMOVE",k.uuid),t.dispatch("DIR_IMAGE_LIST_REMOVE",k),y(!0)):k.deleting=!1})})},b=k=>{Ie.confirm(`
    <div>\u6B64\u64CD\u4F5C\u5C06\u4F1A\u6C38\u4E45\u5220\u9664\u56FE\u7247\uFF1A</div>
    <strong>${k.name}</strong>
    `,"\u5220\u9664\u63D0\u793A",{dangerouslyUseHTMLString:!0,type:"warning"}).then(()=>{E(k)}).catch(()=>{console.log("\u53D6\u6D88\u5220\u9664")})},S=k=>{k.checked=!k.checked,t.commit("IMAGE_CARD",{imageObj:k})},f=async k=>{n("update:modelValue",s.index),_.value=Oe(k.name),await ut(()=>{const O=setTimeout(()=>{var Y;(Y=p.value)==null||Y.focus(),clearTimeout(O)},150)})},A=()=>{n("update:modelValue",void 0)},I=async()=>{A();const{imageObj:k}=s;if(_.value===Oe(k.name)||!_.value)return;const O=async()=>{const Y=Ne.service({lock:!0,text:"\u6B63\u5728\u91CD\u547D\u540D..."}),K=Ye(k.name),y={name:_.value+k.name.substring(k.name.indexOf(".")),size:k.size,lastModified:Date.now(),type:`image/${K}`},F=await ls(r.value,K);if(F){const L=rs(F,y);L&&await Ut(u,L)&&(_.value="",await E(k,!0),await t.dispatch("UPLOADED_LIST_REMOVE",L.uuid))}Y.close()};Ie.confirm(`\u8BE5\u56FE\u7247\u91CD\u547D\u540D\u4E3A ${_.value} \uFF1F`,"\u63D0\u793A",{type:"warning"}).then(async()=>{await O()}).catch(()=>{console.log("\u53D6\u6D88\u56FE\u7247\u91CD\u547D\u540D")})},N=k=>{v.value=k},ae=k=>{Ie.confirm(`
    <div>\u56FE\u7247\u540D\u79F0\uFF1A<strong>${k.name}</strong></div>
    <div>\u56FE\u7247\u5927\u5C0F\uFF1A<strong>${Je(k.size)} KB</strong></div>
    `,"\u5C5E\u6027",{showCancelButton:!1,showConfirmButton:!1,dangerouslyUseHTMLString:!0,type:"info"})};return(k,O)=>{const Y=ye,K=qe,y=H("Check"),F=fe,L=H("MoreFilled"),V=it,Q=lt,Z=rt,Ae=$e;return q((m(),C("div",{class:le(["image-card",{listing:e.listing,checked:e.imageObj.checked}]),"element-loading-text":"\u5220\u9664\u4E2D...",onMouseenter:O[5]||(O[5]=ee=>h.value=!0),onMouseleave:O[6]||(O[6]=ee=>h.value=!1)},[l("div",ps,[l("img",{"data-fancybox":"gallery",src:c(r)},null,8,_s)]),l("div",ms,[l("div",fs,[_.value&&s.modelValue===s.index?(m(),w(Y,{key:0,size:"small",class:"rename-input",modelValue:_.value,"onUpdate:modelValue":O[0]||(O[0]=ee=>_.value=ee),onBlur:A,onKeydown:pn(oe(I,["prevent"]),["enter"]),ref_key:"renameInputRef",ref:p},null,8,["modelValue","onKeydown"])):(m(),C("div",gs,G(e.imageObj.name),1)),l("div",hs,[d(K,{"img-obj":e.imageObj},null,8,["img-obj"])])])]),q(l("div",Es,[l("div",vs,[c(i)?(m(),C("div",{key:0,class:le([e.imageObj.checked?"picked-btn":"pick-btn","operation-btn"]),onClick:O[1]||(O[1]=ee=>S(e.imageObj))},[e.imageObj.checked?(m(),w(F,{key:0},{default:g(()=>[d(y)]),_:1})):D("",!0)],2)):D("",!0)]),l("div",Fs,[d(Z,{size:"default",trigger:"click",onVisibleChange:N},{dropdown:g(()=>[d(Q,null,{default:g(()=>[d(V,{onClick:O[2]||(O[2]=ee=>b(e.imageObj))},{default:g(()=>[T(" \u5220\u9664 ")]),_:1}),d(V,{onClick:O[3]||(O[3]=oe(ee=>f(e.imageObj),["self"]))},{default:g(()=>[T(" \u91CD\u547D\u540D ")]),_:1}),d(V,{onClick:O[4]||(O[4]=ee=>ae(e.imageObj))},{default:g(()=>[T(" \u5C5E\u6027 ")]),_:1})]),_:1})]),default:g(()=>[l("div",Ds,[d(F,null,{default:g(()=>[d(L)]),_:1})])]),_:1})])],512),[[he,h.value||v.value||e.imageObj.checked]])],34)),[[Ae,e.imageObj.deleting]])}}});var Bt=j(Is,[["__scopeId","data-v-ab9df9e6"]]);const Cs={key:0,class:"selected-info-bar-box"},As={class:"info-item"},bs={key:0,class:"info-item"},Ss={class:"info-item"},ys=z({__name:"selected-info-bar",props:{barType:{type:String,default:"upload"}},setup(e){const n=X(),s=$(()=>n.getters.getUserConfigInfo);return $(()=>n.getters.getUserSettings),(t,a)=>{const u=_n;return c(s).selectedRepos?(m(),C("div",Cs,[l("span",As,[T(" \u4ED3\u5E93\uFF1A "),d(u,{"disable-transitions":""},{default:g(()=>[T(G(c(s).selectedRepos),1)]),_:1})]),c(s).selectedBranch?(m(),C("span",bs,[T(" \u5206\u652F\uFF1A "),d(u,{"disable-transitions":""},{default:g(()=>[T(G(c(s).selectedBranch),1)]),_:1})])):D("",!0),l("span",Ss,[T(" \u76EE\u5F55\uFF1A "),d(u,{"disable-transitions":""},{default:g(()=>[T(G(e.barType==="management"?c(s).viewDir:c(s).selectedDir),1)]),_:1})])])):D("",!0)}}});var Ke=j(ys,[["__scopeId","data-v-8c50316c"]]);const $s=z({name:"to-upload-image-card",components:{copyExternalLink:qe,selectedInfoBar:Ke},props:{loadingAllImage:{type:Boolean,default:!1}},setup(){const e=X(),n=we({isShowDialog:!1,curImgInfo:{size:""},userConfigInfo:$(()=>e.getters.getUserConfigInfo).value,userSettings:$(()=>e.getters.getUserSettings).value,toUploadImage:$(()=>e.getters.getToUploadImage).value,hashRename(t,a){t?a.filename.now=`${a.filename.name}.${a.filename.hash}.${a.filename.suffix}`:a.filename.now=`${a.filename.name}.${a.filename.suffix}`},prefixName(t,a){t?a.filename.name=`${a.filename.prefixName}${a.filename.initName}`:a.filename.name=`${a.filename.initName}`,a.filename.isHashRename?a.filename.now=`${a.filename.name}.${a.filename.hash}.${a.filename.suffix}`:a.filename.now=`${a.filename.name}.${a.filename.suffix}`},rename(t,a){t?a.filename.name=a.filename.newName.trim().replace(/\s+/g,"-"):n.prefixName(a.filename.isPrefix,a),a.filename.isHashRename?a.filename.now=`${a.filename.name}.${a.filename.hash}.${a.filename.suffix}`:a.filename.now=`${a.filename.name}.${a.filename.suffix}`},getFileSize(t){return`${Je(t)} KB`},formatLastModified(t){return He.formatTimestamp(t)},async uploadImage_all(t){if(this.toUploadImage.list.length===1)return await Ut(t,this.toUploadImage.list[0])?se.uploaded:se.uploadFail;try{return await ds(t,this.toUploadImage.list),se.allUploaded}catch(a){return console.error(a),se.uploadFail}}}),s=t=>{e.dispatch("TO_UPLOAD_IMAGE_LIST_REMOVE",t.uuid)};return te(()=>{const{defaultHash:t,defaultPrefix:a,prefixName:u}=n.userSettings;n.toUploadImage.list.forEach(o=>{o.filename.isPrefix=a,o.filename.prefixName=u,n.prefixName(a,o),o.filename.isHashRename=t,n.hashRename(t,o)})}),Ve(de({},ke(n)),{removeToUploadImage:s})}}),ws={key:0,class:"to-upload-image-list-card"},ks={class:"header"},Ls={key:0},Us={key:0,class:"body"},Bs={class:"image-uploading-info-box"},Ts={class:"left-image-box"},Os=["src"],Ms={class:"right-operation-box"},xs={class:"top"},Rs={class:"image-name"},Ps={class:"image-info"},Vs={key:0,class:"file-size item"},Ns={class:"last-modified item"},zs={key:0,class:"bottom rename-operation"},Gs={key:1,class:"bottom rename-operation"},js=["onClick"];function Hs(e,n,s,t,a,u){const o=Ke,i=ct,r=ye,p=qe,h=H("Upload"),_=fe,v=H("Loading"),E=H("Check"),b=H("Delete"),S=pe;return e.toUploadImage.list.length||e.userConfigInfo.selectedRepos?(m(),C("div",ws,[l("div",ks,[l("div",null,[d(o)]),l("div",null,[e.toUploadImage.list.length?(m(),C("span",Ls," \u5DF2\u4E0A\u4F20\uFF1A"+G(e.toUploadImage.uploadedNumber)+" / "+G(e.toUploadImage.list.length),1)):D("",!0)])]),e.toUploadImage.list.length?(m(),C("div",Us,[l("ul",Bs,[(m(!0),C(_e,null,me(e.toUploadImage.list,(f,A)=>(m(),C("li",{class:le(["image-uploading-info-item",{disable:e.loadingAllImage}]),key:A},[l("div",Ts,[l("img",{"data-fancybox":"gallery",src:f.imgData.base64Url},null,8,Os)]),l("div",Ms,[l("div",xs,[l("div",Rs,G(f.filename.now),1),l("div",Ps,[e.userSettings.isCompress?(m(),C("span",Vs,[l("del",null,G(e.getFileSize(f.fileInfo.originSize)),1)])):D("",!0),l("span",{class:le(["file-size item",{compressed:e.userSettings.isCompress}])},G(e.getFileSize(f.fileInfo.size)),3),l("span",Ns,G(e.formatLastModified(f.fileInfo.lastModified)),1)])]),!f.uploadStatus.uploading&&f.uploadStatus.progress!==100?(m(),C("div",zs,[d(i,{label:"\u54C8\u5E0C\u5316",modelValue:f.filename.isHashRename,"onUpdate:modelValue":I=>f.filename.isHashRename=I,onChange:I=>e.hashRename(I,f)},null,8,["modelValue","onUpdate:modelValue","onChange"]),d(i,{label:"\u91CD\u547D\u540D",modelValue:f.filename.isRename,"onUpdate:modelValue":I=>f.filename.isRename=I,onChange:I=>e.rename(I,f)},null,8,["modelValue","onUpdate:modelValue","onChange"]),f.filename.isRename?(m(),w(r,{key:0,class:"rename-input",size:"small",modelValue:f.filename.newName,"onUpdate:modelValue":I=>f.filename.newName=I,onInput:I=>e.rename(I,f),clearable:""},null,8,["modelValue","onUpdate:modelValue","onInput"])):D("",!0),!f.filename.isRename&&e.userConfigInfo.defaultPrefix&&e.userConfigInfo.prefixName?(m(),w(i,{key:1,label:"\u547D\u540D\u524D\u7F00",modelValue:f.filename.isPrefix,"onUpdate:modelValue":I=>f.filename.isPrefix=I,onChange:I=>e.prefixName(I,f)},null,8,["modelValue","onUpdate:modelValue","onChange"])):D("",!0)])):D("",!0),!f.uploadStatus.uploading&&f.uploadStatus.progress===100?(m(),C("div",Gs,[d(p,{"img-obj":f.uploadedImg},null,8,["img-obj"])])):D("",!0)]),l("div",{class:le(["upload-status-box",{"wait-upload":!f.uploadStatus.uploading&&f.uploadStatus.progress!==100,uploading:f.uploadStatus.uploading&&f.uploadStatus.progress!==100,uploaded:!f.uploadStatus.uploading&&f.uploadStatus.progress===100}])},[!f.uploadStatus.uploading&&f.uploadStatus.progress!==100?(m(),w(_,{key:0},{default:g(()=>[d(h)]),_:1})):D("",!0),f.uploadStatus.uploading&&f.uploadStatus.progress!==100?(m(),w(_,{key:1,class:"is-loading"},{default:g(()=>[d(v)]),_:1})):D("",!0),!f.uploadStatus.uploading&&f.uploadStatus.progress===100?(m(),w(_,{key:2},{default:g(()=>[d(E)]),_:1})):D("",!0)],2),f.uploadStatus.progress!==100&&!f.uploadStatus.uploading?(m(),C("div",{key:0,class:"remove-to-upload-image",onClick:I=>e.removeToUploadImage(f)},[d(S,{effect:"dark",content:"\u79FB\u9664",placement:"top"},{default:g(()=>[d(_,null,{default:g(()=>[d(b)]),_:1})]),_:1})],8,js)):D("",!0)],2))),128))])])):D("",!0)])):D("",!0)}var Xs=j($s,[["render",Hs]]);const We=async(e,n)=>{if(!e)return null;if(!bt(e.type))return x.error("\u8BE5\u6587\u4EF6\u683C\u5F0F\u4E0D\u652F\u6301\uFF01"),null;let s;const{isCompress:t,compressEncoder:a}=R.getters.getUserSettings,u=e.type==="image/gif";if(!u&&t){const o=Ne.service({target:".upload-area",text:"\u6B63\u5728\u538B\u7F29\u56FE\u7247"});s=await zn(e,a),o.close()}return new Promise(o=>{const i=new FileReader;i.readAsDataURL(!u&&t?s:e),i.onload=r=>{var _;const p=(_=r.target)==null?void 0:_.result,h=Je(p.length);h>=n?Ie.confirm(`\u5F53\u524D\u56FE\u7247 ${(h/1024).toFixed(2)} M\uFF0CCDN \u53EA\u80FD\u52A0\u901F\u5C0F\u4E8E 50 MB \u7684\u56FE\u7247\uFF0C\u5EFA\u8BAE\u4F7F\u7528\u7B2C\u4E09\u65B9\u5DE5\u5177 TinyPNG \u538B\u7F29`,"\u56FE\u7247\u8FC7\u5927\uFF0C\u7981\u6B62\u4E0A\u4F20",{confirmButtonText:"\u524D\u5F80 TinyPNG",cancelButtonText:"\u653E\u5F03\u4E0A\u4F20"}).then(()=>{window.open("https://tinypng.com/")}).catch(()=>{console.log("\u653E\u5F03\u4E0A\u4F20")}):o({base64:p,originalFile:e,compressFile:!u&&t?s:e})}})},Ys=(e,n)=>e.clipboardData&&e.clipboardData.items?new Promise(s=>{var t;for(let a=0,u=e.clipboardData.items.length;a<u;a++){const o=e.clipboardData.items[a];if(o.kind==="file"){const i=o.getAsFile();(t=We(i,n))==null||t.then(r=>{if(!r)return;const{base64:p,originalFile:h,compressFile:_}=r;s({base64:p,originalFile:h,compressFile:_})})}}}):null;const Js=z({name:"upload-area",props:{imageLoading:{type:Boolean,default:!1}},setup(){const e=X(),n=we({userConfigInfo:$(()=>e.getters.getUserConfigInfo).value,userSettings:$(()=>e.getters.getUserSettings).value,uploadAreaActive:$(()=>e.getters.getUploadAreaActive),uploadSettings:$(()=>e.getters.getUploadSettings).value,toUploadImage:$(()=>e.getters.getToUploadImage).value,onSelect(a){var u;e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0);for(const o of a.target.files)(u=We(o,this.uploadSettings.imageMaxSize))==null||u.then(i=>{if(!i)return;const{base64:r,originalFile:p,compressFile:h}=i;this.getImage(r,p,h)})},onDrop(a){var u;e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0);for(const o of a.dataTransfer.files)(u=We(o,this.uploadSettings.imageMaxSize))==null||u.then(i=>{if(!i)return;const{base64:r,originalFile:p,compressFile:h}=i;this.getImage(r,p,h)})},async onPaste(a){e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0);const{base64:u,originalFile:o,compressFile:i}=await Ys(a,this.uploadSettings.imageMaxSize);this.getImage(u,o,i)},getImage(a,u,o){this.toUploadImage.list.length===this.toUploadImage.uploadedNumber&&this.toUploadImage.list.length>0&&this.toUploadImage.uploadedNumber>0&&(e.dispatch("TO_UPLOAD_IMAGE_CLEAN_LIST"),e.dispatch("TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER"));const{defaultHash:i,isCompress:r,defaultPrefix:p,prefixName:h}=this.userSettings,_=r?o:u,v=kt();v.imgData.base64Url=a,v.imgData.base64Content=a.split(",")[1];const{name:E,hash:b,suffix:S}=St(_==null?void 0:_.name);v.uuid=b,v.fileInfo.compressedSize=o==null?void 0:o.size,v.fileInfo.originSize=u.size,v.fileInfo.size=_==null?void 0:_.size,v.fileInfo.lastModified=_==null?void 0:_.lastModified,v.filename.initName=E,v.filename.name=p?`${h}${E}`:E,v.filename.prefixName=h,v.filename.hash=b,v.filename.suffix=S,v.filename.now=i?`${v.filename.name}.${b}.${S}`:`${v.filename.name}.${S}`,v.filename.isHashRename=i,v.filename.isPrefix=p,e.dispatch("TO_UPLOAD_IMAGE_LIST_ADD",JSON.parse(JSON.stringify(v))),e.dispatch("TO_UPLOAD_IMAGE_SET_CURRENT",{uuid:b,base64Url:a})},onFocus(){e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0)}}),s=ke(n),t=n.onPaste.bind(n);return te(()=>{window.addEventListener("paste",t)}),mn(()=>{window.removeEventListener("paste",t)}),de({},s)}}),qs=e=>(ue("data-v-0a450f9d"),e=e(),ie(),e),Ks={key:0,for:"uploader",class:"active-upload"},Ws={key:1,class:"tips active-upload"},Qs=qs(()=>l("div",{class:"text active-upload"},"\u62D6\u62FD\u3001\u7C98\u8D34\u3001\u6216\u70B9\u51FB\u6B64\u5904\u4E0A\u4F20",-1)),Zs=["src"];function ea(e,n,s,t,a,u){const o=H("UploadFilled"),i=fe,r=$e;return q((m(),C("div",{class:le(["upload-area active-upload",{focus:e.uploadAreaActive}]),onDragover:n[2]||(n[2]=oe(()=>{},["prevent"])),onDrop:n[3]||(n[3]=oe((...p)=>e.onDrop&&e.onDrop(...p),["stop","prevent"])),onPaste:n[4]||(n[4]=oe((...p)=>e.onPaste&&e.onPaste(...p),["stop"])),"element-loading-text":"\u56FE\u7247\u4E0A\u4F20\u4E2D...","element-loading-background":"rgba(0, 0, 0, 0.5)"},[e.uploadAreaActive?(m(),C("label",Ks)):D("",!0),l("input",{id:"uploader",type:"file",onChange:n[0]||(n[0]=(...p)=>e.onSelect&&e.onSelect(...p)),multiple:"multiple",autofocus:"",onFocus:n[1]||(n[1]=(...p)=>e.onFocus&&e.onFocus(...p))},null,32),e.toUploadImage.curImgBase64Url?D("",!0):(m(),C("div",Ws,[d(i,{class:"icon active-upload"},{default:g(()=>[d(o)]),_:1}),Qs])),e.toUploadImage.curImgBase64Url?(m(),C("img",{key:2,class:"active-upload",src:e.toUploadImage.curImgBase64Url,alt:"Pictures to be uploaded"},null,8,Zs)):D("",!0)],34)),[[r,e.imageLoading]])}var ta=j(Js,[["render",ea],["__scopeId","data-v-0a450f9d"]]);const na={class:"upload-page-container"},sa={key:0,class:"upload-page-left page-container",style:{width:"280rem"}},aa={class:"upload-page-right page-container"},oa={class:"row-item"},ua={class:"content-box"},ia={class:"row-item"},la={class:"content-box"},ra={class:"row-item"},ca={class:"content-box",style:{"text-align":"right"}},da=z({__name:"upload",setup(e){const n=X(),s=De();B(null),B(null);const t=B(null),a=B(null),u=$(()=>n.getters.getUserConfigInfo),o=$(()=>n.getters.getUserSettings),i=$(()=>n.getters.getUserLoggingStatus),r=$(()=>n.getters.getUploadedImageList),p=$(()=>n.getters.getToUploadImage),h=B(!1),_=()=>{const{token:E,selectedRepos:b,selectedDir:S}=u.value;if(!E){x.error("\u8BF7\u5148\u5B8C\u6210\u56FE\u5E8A\u914D\u7F6E\uFF01"),s.push("/config");return}if(!b){x.error("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93\uFF01"),s.push("/config");return}if(!S){x.error("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),s.push("/config");return}if(p.value.list.length===0){x.error("\u56FE\u7247\u4E0D\u80FD\u4E3A\u7A7A\uFF01");return}if(p.value.list.length===p.value.uploadedNumber){x.error("\u8BF7\u9009\u62E9\u8981\u4E0A\u4F20\u7684\u56FE\u7247\uFF01");return}h.value=!0,t.value.uploadImage_all(u.value).then(f=>{switch(f){case se.uploaded:case se.allUploaded:h.value=!1,n.dispatch("TO_UPLOAD_IMAGE_CLEAN_URL");break;case se.uploadFail:h.value=!1,n.dispatch("TO_UPLOAD_IMAGE_LIST_FAIL");break}}).catch(f=>{console.error("upload error: ",f),h.value=!1})},v=()=>{h.value=!1,n.dispatch("TO_UPLOAD_IMAGE_LOGOUT")};return W(()=>i,E=>{!E&&v()}),(E,b)=>{const S=ze;return m(),C("div",na,[c(r).length&&c(o).elementPlusSize==="large"?(m(),C("div",sa,[(m(!0),C(_e,null,me(c(r),(f,A)=>(m(),C("div",{class:"uploaded-item",key:A},[d(Bt,{"image-obj":f,"is-uploaded":!0},null,8,["image-obj"])]))),128))])):D("",!0),l("div",aa,[l("div",oa,[l("div",ua,[d(ta,{"image-loading":h.value,ref_key:"uploadAreaDom",ref:a},null,8,["image-loading"])])]),l("div",ia,[l("div",la,[d(Xs,{ref_key:"toUploadImageCardDom",ref:t,"loading-all-image":h.value},null,8,["loading-all-image"])])]),l("div",ra,[l("div",ca,[c(p).list.length?(m(),w(S,{key:0,plain:"",type:"warning",onClick:v},{default:g(()=>[T("\u91CD\u7F6E ")]),_:1})):D("",!0),d(S,{plain:"",type:"primary",onClick:_},{default:g(()=>[T(" \u4E0A\u4F20 ")]),_:1})])])])])}}});const Tt=e=>(ue("data-v-5d9c41a5"),e=e(),ie(),e),pa=Tt(()=>l("div",{class:"icon"},[l("svg",{t:"1639999626518",class:"icon",viewBox:"0 0 1228 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3575",width:"200",height:"200"},[l("path",{d:"M1196.987733 212.5824v540.0576c0 39.594667-34.474667 71.3728-76.765866 71.3728H323.242667c-51.780267 0-88.746667-46.762667-73.250134-92.808533l126.737067-375.808H70.417067C31.675733 355.362133 0 326.4512 0 291.089067V98.372267C0 63.044267 31.675733 34.0992 70.417067 34.0992h378.811733c26.7264 0 51.029333 13.9264 63.010133 35.703467l39.048534 71.406933H1120.256c42.257067 0 76.8 32.119467 76.8 71.3728",fill:"#5398DF","p-id":"3576"}),l("path",{d:"M1128.721067 997.853867H68.266667a68.266667 68.266667 0 0 1-68.266667-68.266667V280.3712a68.266667 68.266667 0 0 1 68.266667-68.266667h1060.4544a68.266667 68.266667 0 0 1 68.266666 68.266667V929.5872a68.266667 68.266667 0 0 1-68.266666 68.266667",fill:"#85BCFF","p-id":"3577"})])],-1)),_a={key:1,class:"icon"},ma=Tt(()=>l("svg",{t:"1640264285200",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"29312",width:"200",height:"200"},[l("path",{d:"M426.666667 384V213.333333l-298.666667 298.666667 298.666667 298.666667v-174.933334c213.333333 0 362.666667 68.266667 469.333333 217.6-42.666667-213.333333-170.666667-426.666667-469.333333-469.333333z","p-id":"29313",fill:"#85BCFF"})],-1)),fa=[ma],ga={key:2,class:"text"},ha={key:3,class:"text"},Ea=z({__name:"folder-card",props:{folderObj:{type:Object,default:()=>{}},mode:{type:String,default:"dir"}},setup(e){const n=e,s=X(),t=$(()=>s.getters.getUserConfigInfo).value,a=()=>{const{folderObj:u,mode:o}=n;if(o==="back"){const i=t.viewDir;if(i==="/")return;const r=i.split("/");r.length===1?t.viewDir="/":r.length>1&&(r.length-=1,t.viewDir=r.join("/"))}o==="dir"&&(t.viewDir=u.dirPath),s.dispatch("USER_CONFIG_INFO_PERSIST")};return(u,o)=>{const i=pe;return m(),C("div",{class:"folder-card",onDblclick:a},[e.mode==="dir"?(m(),w(i,{key:0,content:"\u53CC\u51FB\u8FDB\u5165\u4E0B\u4E00\u7EA7\u76EE\u5F55",placement:"top"},{default:g(()=>[pa]),_:1})):D("",!0),e.mode==="back"?(m(),C("div",_a,fa)):D("",!0),e.mode==="dir"?(m(),C("div",ga,G(e.folderObj.dir),1)):D("",!0),e.mode==="back"?(m(),C("div",ha,"\u53CC\u51FB\u540E\u9000")):D("",!0)],32)}}});var Ot=j(Ea,[["__scopeId","data-v-5d9c41a5"]]);async function va(e,n){e.deleting=!0;const{owner:s,selectedRepos:t}=n;return new Promise((a,u)=>{P.delete(`/repos/${s}/${t}/contents/${e.path}`,{data:{owner:s,repo:t,path:e.path,message:"Delete image via PicX(https://github.com/XPoet/picx)",sha:e.sha}}).then(o=>{o&&o.status===200?(e.deleting=!1,R.dispatch("UPLOADED_LIST_REMOVE",e.uuid),R.dispatch("DIR_IMAGE_LIST_REMOVE",e),a(!0)):(e.deleting=!1,a(!1))}).catch(o=>{u(o)})})}async function Fa(e,n){var p,h,_,v;e.forEach(E=>{E.deleting=!0});const{owner:s,selectedRepos:t,selectedBranch:a}=n,u=await P.get(`/repos/${s}/${t}/branches/${a}`);if((u==null?void 0:u.status)!==200)throw e.forEach(E=>{E.deleting=!1}),new Error("\u83B7\u53D6\u5206\u652F\u4FE1\u606F\u5931\u8D25");const o=await P.post(`/repos/${s}/${t}/git/trees`,{tree:e.map(E=>({mode:"100644",path:E.path,sha:null,type:"blob"})),base_tree:((v=(_=(h=(p=u==null?void 0:u.data)==null?void 0:p.commit)==null?void 0:h.commit)==null?void 0:_.tree)==null?void 0:v.sha)||null});if((o==null?void 0:o.status)!==201)throw e.forEach(E=>{E.deleting=!1}),new Error("\u521B\u5EFA tree \u5931\u8D25");const i=await P.post(`/repos/${s}/${t}/git/commits`,{message:"Delete images via PicX(https://github.com/XPoet/picx)",parents:[u.data.commit.sha],tree:o.data.sha});if((i==null?void 0:i.status)!==201)throw e.forEach(E=>{E.deleting=!1}),new Error("\u521B\u5EFA commit \u5931\u8D25");const r=await P.patch(`/repos/${s}/${t}/git/refs/heads/${a}`,{sha:i.data.sha});if((r==null?void 0:r.status)!==200)throw e.forEach(E=>{E.deleting=!1}),new Error("\u66F4\u65B0 ref \u5931\u8D25");e.forEach(E=>{E.deleting=!1,R.dispatch("UPLOADED_LIST_REMOVE",E.uuid),R.dispatch("DIR_IMAGE_LIST_REMOVE",E)})}async function Da(e,n){if(e.length===1)return await va(e[0],n)?ne.deleted:ne.deleteFail;try{return await Fa(e,n),ne.allDeleted}catch(s){return console.error(s),ne.deleteFail}}const Ia={key:0,class:"selector-wrapper"},Ca={class:"selector-left-box"},Aa={class:"item"},ba={class:"selector-right-box"},Sa=z({__name:"image-selector",props:{currentDirImageList:{type:Array,default:()=>[]}},emits:["update:initImageList"],setup(e){const n=e,s=X(),t=B(!1),a=$(()=>s.getters.getImageCardCheckedArr),u=$(()=>s.getters.getUserConfigInfo).value,o=$(()=>s.getters.getUserSettings).value,i=$(()=>a.value.length||0);W(()=>i.value,v=>{const E=n.currentDirImageList.length;t.value=v===E});function r(){Jn(a.value,o.externalLinkType)}function p(){n.currentDirImageList.forEach(v=>{v.checked&&(v.checked=!1)})}async function h(){var v;((v=a.value)==null?void 0:v.length)>0?Ie.confirm("\u662F\u5426\u6279\u91CF\u5220\u9664\u5DF2\u9009\u4E2D\u7684\u56FE\u7247\uFF1F","\u5220\u9664\u63D0\u793A",{type:"warning"}).then(async()=>{const E=await Da(a.value,u);E===ne.deleted&&x.success("\u5220\u9664\u6210\u529F\uFF01"),E===ne.allDeleted&&x.success("\u6279\u91CF\u5220\u9664\u6210\u529F\uFF01"),E===ne.deleteFail&&x.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5\uFF01")}).catch(()=>{console.log("\u53D6\u6D88\u6279\u91CF\u5220\u9664")}):x.warning("\u8BF7\u5148\u9009\u62E9\u56FE\u7247")}function _(){let v=[];n.currentDirImageList.forEach(E=>{E.checked=t.value}),v=n.currentDirImageList,s.commit("REPLACE_IMAGE_CARD",{checkedImgArr:v})}return te(()=>{_()}),(v,E)=>{const b=ct,S=H("CopyDocument"),f=fe,A=pe,I=H("Delete");return c(i)?(m(),C("div",Ia,[l("div",Ca,[d(b,{label:t.value?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009",modelValue:t.value,"onUpdate:modelValue":E[0]||(E[0]=N=>t.value=N),onChange:_},null,8,["label","modelValue"]),l("div",Aa,"\u5DF2\u9009\u62E9 "+G(c(i))+" \u5F20\u56FE\u7247",1),l("div",{class:"item cancel-select-btn",onClick:p},"\u53D6\u6D88\u9009\u62E9")]),l("div",ba,[d(A,{placement:"top",content:"\u6279\u91CF\u590D\u5236\u5916\u94FE"},{default:g(()=>[d(f,{class:"btn-icon",onClick:r},{default:g(()=>[d(S)]),_:1})]),_:1}),d(A,{placement:"top",content:"\u6279\u91CF\u5220\u9664\u56FE\u7247"},{default:g(()=>[d(f,{class:"btn-icon",onClick:h},{default:g(()=>[d(I)]),_:1})]),_:1})])])):D("",!0)}}});var ya=j(Sa,[["__scopeId","data-v-19e5e208"]]);const $a=e=>(ue("data-v-06d1e340"),e=e(),ie(),e),wa={class:"page-container management-page-container"},ka={class:"content-container"},La={class:"top"},Ua={class:"left"},Ba={class:"right flex-start"},Ta={class:"bottom","element-loading-text":"\u52A0\u8F7D\u4E2D..."},Oa={key:0,class:"image-item"},Ma=$a(()=>l("div",{class:"clear"},null,-1)),xa=z({__name:"management",setup(e){const n=X(),s=De(),t=$(()=>n.getters.getUserConfigInfo).value,a=$(()=>n.getters.getUserLoggingStatus).value,u=$(()=>n.getters.getDirObject).value,o=B(new Date().getTime()),i=B(!1),r=B(!1),p=B(),h=B([]),_=B([]);async function v(A){i.value=!0;const I=Ue(A,u);if(I){const N=Be(A,I,"dir"),ae=Be(A,I,"image");!N.length&&!ae.length?await xe(A):(h.value=N,_.value=ae,n.commit("REPLACE_IMAGE_CARD",{checkedImgArr:_.value}))}else await xe(A);i.value=!1}async function E(){const{selectedDir:A,viewDir:I,dirMode:N}=t;if(I===""&&((N===J.newDir||N===J.autoDir)&&!Ue(A,u)&&(t.selectedDir="/",t.dirMode="rootDir"),t.selectedDir?t.viewDir=t.selectedDir:t.viewDir="/"),!u.imageList.length&&!u.childrenDirs.length){await xe(t.viewDir);return}await v(t.viewDir)}function b(){r.value=!r.value}async function S(){const{viewDir:A}=t;await n.dispatch("DIR_IMAGE_LIST_INIT_DIR",A),i.value=!0,await xe(A),i.value=!1}te(()=>{E()}),W(()=>a,A=>{A===!1&&s.push("/config")}),W(()=>t.viewDir,async A=>{await v(A),o.value+=1},{deep:!0}),W(()=>u,A=>{const{viewDir:I}=t,N=Ue(I,A);N&&(h.value=Be(I,N,"dir"),_.value=Be(I,N,"image"),n.commit("REPLACE_IMAGE_CARD",{checkedImgArr:_.value}))},{deep:!0});const f=B(!1);return W(()=>_.value,A=>{f.value=A.filter(I=>I.checked).length>0},{deep:!0}),(A,I)=>{const N=H("Tickets"),ae=H("Menu"),k=fe,O=pe,Y=H("Refresh"),K=$e;return m(),C("div",wa,[l("div",ka,[l("div",La,[l("div",Ua,[d(Ke,{"bar-type":"management"})]),l("div",Ba,[d(O,{placement:"top",content:r.value?"\u5207\u6362\u65B9\u5757\u5C55\u793A":"\u5207\u6362\u5217\u8868\u5C55\u793A"},{default:g(()=>[d(k,{class:"btn-icon",onClick:oe(b,["stop"])},{default:g(()=>[r.value?(m(),w(N,{key:0})):D("",!0),r.value?D("",!0):(m(),w(ae,{key:1}))]),_:1},8,["onClick"])]),_:1},8,["content"]),d(O,{placement:"top",content:"\u91CD\u65B0\u52A0\u8F7D"},{default:g(()=>[d(k,{class:"btn-icon",onClick:oe(S,["stop"])},{default:g(()=>[d(Y)]),_:1},8,["onClick"])]),_:1})])]),q((m(),C("div",Ta,[_.value.length?(m(),w(ya,{currentDirImageList:_.value,"onUpdate:initImageList":_.value,key:o.value},null,8,["currentDirImageList","onUpdate:initImageList"])):D("",!0),l("ul",{class:"image-list",style:dt({height:f.value?"calc(100% - 50rem)":"100%"})},[c(t).viewDir!=="/"?(m(),C("li",Oa,[d(Ot,{mode:"back"})])):D("",!0),(m(!0),C(_e,null,me(h.value,(y,F)=>(m(),C("li",{class:"image-item",key:F},[d(Ot,{"folder-obj":y},null,8,["folder-obj"])]))),128)),Ma,(m(!0),C(_e,null,me(_.value,(y,F)=>(m(),C("li",{class:"image-item",key:F,style:dt({width:r.value?"50%":"230rem",height:r.value?"80rem":"240rem"})},[d(Bt,{"image-obj":y,listing:r.value,modelValue:p.value,"onUpdate:modelValue":I[0]||(I[0]=L=>p.value=L),index:F},null,8,["image-obj","listing","modelValue","index"])],4))),128))],4)])),[[K,i.value]])])])}}});var Ra=j(xa,[["__scopeId","data-v-06d1e340"]]);const Pa={},Va={class:"tutorials-step-3"},Na=fn('<h3>\u8FDB\u884C\u56FE\u5E8A\u914D\u7F6E\uFF08\u7ED1\u5B9A GitHub Token\u3001\u5B58\u50A8\u56FE\u7247\u7684\u4ED3\u5E93\u548C\u76EE\u5F55\uFF09</h3><p>1\u3001\u586B\u5199 Token\uFF0C\u81EA\u52A8\u83B7\u53D6\u8BE5\u7528\u6237\u4E0B\u7684\u4ED3\u5E93</p><img src="https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.4g8q5m7c8sq0.png"><br><p>2\u3001\u5728\u4ED3\u5E93\u7684\u4E0B\u62C9\u5217\u8868\u4E2D\uFF0C\u9009\u62E9\u4E00\u4E2A\u4F5C\u4E3A\u56FE\u5E8A\u7684\u4ED3\u5E93</p><img src="https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.746g75olruk0.png"><br><p>3\u3001\u9009\u62E9\u4E00\u79CD\u76EE\u5F55\u65B9\u5F0F\uFF08\u76EE\u5F55\u5373\u4ED3\u5E93\u91CC\u5B58\u653E\u56FE\u7247\u7684\u6587\u4EF6\u5939\uFF09</p><img src="https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.5ydmhgxjhgo0.png"><div class="dir-desc-box"><ul><li>\u65B0\u5EFA\u76EE\u5F55\uFF1A\u9700\u624B\u52A8\u8F93\u5165\u4E00\u4E2A\u65B0\u76EE\u5F55\u3002</li><li>\u6839\u76EE\u5F55\uFF1A\u56FE\u7247\u5C06\u76F4\u63A5\u5B58\u50A8\u5728\u4ED3\u5E93\u6839\u76EE\u5F55\u4E0B\u3002</li><li>\u81EA\u52A8\u76EE\u5F55\uFF1A\u81EA\u52A8\u751F\u6210\u65E5\u671F\u683C\u5F0F YYYYMMDD \u7684\u76EE\u5F55\u3002\u4F8B\u5982\uFF1A20200909</li><li>\u9009\u62E9\u4ED3\u5E93\u76EE\u5F55\uFF1A\u81EA\u52A8\u83B7\u53D6\u4ED3\u5E93\u4E0B\u6240\u6709\u76EE\u5F55\uFF0C\u9009\u62E9\u4E00\u4E2A\u5373\u53EF\u3002</li></ul></div>',10),za=[Na];function Ga(e,n){return m(),C("div",Va,za)}var Mt=j(Pa,[["render",Ga]]);const ja={class:"tutorials-step-2"},Ha=l("img",{src:"https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.lpt1xl9fu.png",alt:"Create GitHub Token"},null,-1),Xa=l("p",null,"\u7136\u540E\u70B9\u51FB Generate token \u6309\u94AE\uFF0C\u5373\u53EF\u751F\u6210\u4E00\u4E2Atoken\uFF0C\u5982\u4E0B\u56FE\uFF1A",-1),Ya=l("img",{src:"https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.pzmcp6b80fk.png",alt:"token-demo"},null,-1),Ja=l("p",{style:{color:"red"}},[l("em",null,"\u65B0\u751F\u6210\u7684 Token \u53EA\u4F1A\u663E\u793A\u4E00\u6B21\uFF0C\u8BF7\u59A5\u5584\u4FDD\u5B58\uFF01\u5982\u6709\u9057\u5931\uFF0C\u91CD\u65B0\u751F\u6210\u5373\u53EF\u3002")],-1),xt=z({__name:"step2",setup(e){function n(){window.open("https://github.com/settings/tokens/new")}return(s,t)=>(m(),C("div",ja,[l("h3",null,[T(" \u521B\u5EFA\u4E00\u4E2A\u6709 repo \u6743\u9650\u7684 "),l("span",{class:"go-create-token",onClick:n}," GitHub Token")]),Ha,Xa,Ya,Ja]))}});const qa={class:"tutorials-step-1"},Ka=l("img",{src:"https://cdn.staticaly.com/gh/XPoet/image-hosting@master/PicX/image.j1486dtk68n.png",alt:"Create GitHub Repository"},null,-1),Rt=z({__name:"step1",setup(e){function n(){window.open("https://github.com/new")}return(s,t)=>(m(),C("div",qa,[l("h3",null,[T(" \u521B\u5EFA\u4E00\u4E2A\u7528\u6765\u5B58\u50A8\u56FE\u7247\u7684 "),l("span",{class:"go-create-repo",onClick:n}," GitHub \u4ED3\u5E93")]),Ka]))}});const Wa=z({name:"tutorials",components:{Step1:Rt,Step2:xt,Step3:Mt},setup(){const e=B(0);return{stepNum:e,step:s=>{s==="prev"&&(e.value<0?e.value=0:e.value-=1),s==="next"&&(e.value>3?e.value=3:e.value+=1)}}}}),Pt=e=>(ue("data-v-0275023f"),e=e(),ie(),e),Qa={class:"page-container tutorials-page-container"},Za={class:"step-content"},eo={key:3},to=Pt(()=>l("h2",null,"\u{1F44D} \u606D\u559C\u4F60\u5B8C\u6210\u56FE\u5E8A\u4F7F\u7528\u6559\u7A0B \u{1F31F} \u5FEB\u53BB\u8BD5\u8BD5\u5427~",-1)),no=Pt(()=>l("h2",null,"https://github.com/XPoet/picx",-1)),so=[to,no],ao={class:"btn-next-prev"};function oo(e,n,s,t,a,u){const o=gn,i=hn,r=Rt,p=xt,h=Mt,_=ze;return m(),C("div",Qa,[d(i,{active:e.stepNum,"finish-status":"success","align-center":""},{default:g(()=>[d(o,{title:"\u521B\u5EFA GitHub \u4ED3\u5E93"}),d(o,{title:"\u83B7\u53D6 GitHub Token"}),d(o,{title:"\u914D\u7F6E\u56FE\u5E8A"})]),_:1},8,["active"]),l("div",Za,[e.stepNum===0?(m(),w(r,{key:0})):D("",!0),e.stepNum===1?(m(),w(p,{key:1})):D("",!0),e.stepNum===2?(m(),w(h,{key:2})):D("",!0),e.stepNum===3?(m(),C("div",eo,so)):D("",!0)]),l("div",ao,[e.stepNum>0?(m(),w(_,{key:0,type:"primary",onClick:n[0]||(n[0]=v=>e.step("prev"))},{default:g(()=>[T("\u4E0A\u4E00\u6B65 ")]),_:1})):D("",!0),e.stepNum<3?(m(),w(_,{key:1,type:"primary",onClick:n[1]||(n[1]=v=>e.step("next"))},{default:g(()=>[T("\u4E0B\u4E00\u6B65 ")]),_:1})):D("",!0)])])}var uo=j(Wa,[["render",oo],["__scopeId","data-v-0275023f"]]);const ve=e=>(ue("data-v-38b000ea"),e=e(),ie(),e),io={class:"page-container settings-page-container"},lo=ve(()=>l("div",{class:"setting-title"},"\u4E2A\u6027\u8BBE\u7F6E\uFF1A",-1)),ro={class:"setting-list"},co={class:"setting-item"},po={class:"setting-item"},_o={class:"setting-item"},mo=ve(()=>l("div",{class:"setting-title"},"CDN \u63D0\u4F9B\u5546\uFF1A",-1)),fo={class:"setting-list"},go={class:"setting-item"},ho=ve(()=>l("div",{class:"setting-title"},"\u538B\u7F29\u8BBE\u7F6E\uFF1A",-1)),Eo={class:"setting-list"},vo={class:"setting-item"},Fo={class:"setting-item"},Do=ve(()=>l("div",{class:"img-encoder-title"},"\u9009\u62E9\u56FE\u50CF\u7F16\u7801\u5668\uFF08\u538B\u7F29\u7B97\u6CD5\uFF09\uFF1A",-1)),Io=ve(()=>l("div",{class:"setting-title"},"\u4E3B\u9898\u8BBE\u7F6E\uFF1A",-1)),Co={class:"setting-list"},Ao={class:"setting-item"},bo={key:0,class:"setting-title"},So={key:1,class:"setting-list"},yo={class:"setting-item"},$o=ve(()=>l("span",{class:"time-middle-space"}," ~ ",-1)),wo=z({__name:"settings",setup(e){const n=$(()=>R.getters.getUserSettings).value,s=()=>{R.dispatch("USER_SETTINGS_PERSIST")},t=Te,a=()=>{R.dispatch("SET_USER_SETTINGS",de({},n)),s()};return(u,o)=>{const i=pt,r=ye,p=nt,h=st,_=at,v=ot,E=En,b=et,S=tt;return m(),C("div",io,[lo,l("ul",ro,[l("li",co,[d(i,{modelValue:c(n).defaultHash,"onUpdate:modelValue":o[0]||(o[0]=f=>c(n).defaultHash=f),onChange:s,"active-text":"\u4E0A\u4F20\u65F6\u7ED9\u56FE\u7247\u540D\u52A0\u4E0A\u54C8\u5E0C\u7801\uFF08\u786E\u4FDD\u56FE\u7247\u540D\u552F\u4E00\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u5F00\u542F\uFF09"},null,8,["modelValue"])]),l("li",po,[d(i,{modelValue:c(n).defaultPrefix,"onUpdate:modelValue":o[1]||(o[1]=f=>c(n).defaultPrefix=f),onChange:s,"active-text":"\u4E0A\u4F20\u65F6\u7ED9\u56FE\u7247\u540D\u52A0\u4E0A\u914D\u7F6E\u7684\u524D\u7F00\uFF08\u793A\u4F8B\uFF1Aabc-image.jpg\uFF0Cabc- \u4E3A\u524D\u7F00\uFF09"},null,8,["modelValue"]),c(n).defaultPrefix?(m(),w(r,{key:0,class:"prefix-input",modelValue:c(n).prefixName,"onUpdate:modelValue":o[2]||(o[2]=f=>c(n).prefixName=f),placeholder:"\u8BF7\u8F93\u5165\u547D\u540D\u524D\u7F00",onInput:s,clearable:"",autofocus:""},null,8,["modelValue"])):D("",!0)]),l("li",_o,[d(i,{modelValue:c(n).defaultMarkdown,"onUpdate:modelValue":o[3]||(o[3]=f=>c(n).defaultMarkdown=f),onChange:s,"active-text":"\u4E0A\u4F20\u6210\u529F\u540E\u590D\u5236\u7684\u56FE\u7247\u5916\u94FE\u542F\u7528 Markdown \u683C\u5F0F\uFF08![ ... ]( ... )\uFF09"},null,8,["modelValue"])])]),mo,l("ul",fo,[l("li",go,[d(h,{modelValue:c(n).externalLinkType,"onUpdate:modelValue":o[4]||(o[4]=f=>c(n).externalLinkType=f),placeholder:"\u9009\u62E9 CDN \u63D0\u4F9B\u5546",onChange:a},{default:g(()=>[d(p,{label:"Staticaly",value:"staticaly"}),d(p,{label:"zzko",value:"zzko"}),d(p,{label:"jsDelivr",value:"jsdelivr"})]),_:1},8,["modelValue"])])]),ho,l("ul",Eo,[l("li",vo,[d(i,{modelValue:c(n).isCompress,"onUpdate:modelValue":o[5]||(o[5]=f=>c(n).isCompress=f),onChange:s,"active-text":"\u662F\u5426\u538B\u7F29\u56FE\u7247"},null,8,["modelValue"])]),l("li",Fo,[Do,d(v,{disabled:!c(n).isCompress,modelValue:c(n).compressEncoder,"onUpdate:modelValue":o[6]||(o[6]=f=>c(n).compressEncoder=f),onChange:s},{default:g(()=>[d(_,{label:c(t).webP},{default:g(()=>[T(G(c(t).webP)+" \uFF08\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A webp\uFF0C\u5927\u591A\u6570\u73B0\u4EE3\u6D4F\u89C8\u5668\u652F\u6301\uFF09 ",1)]),_:1},8,["label"]),d(_,{label:c(t).mozJPEG},{default:g(()=>[T(G(c(t).mozJPEG)+" \uFF08\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A jpg\uFF0C\u517C\u5BB9\u6027\u6700\u597D\uFF09 ",1)]),_:1},8,["label"]),d(_,{label:c(t).avif},{default:g(()=>[T(G(c(t).avif)+" \uFF08\u538B\u7F29\u540E\u56FE\u7247\u683C\u5F0F\u4E3A avif\uFF0C\u538B\u7F29\u6BD4\u6700\u9AD8\uFF0C\u76EE\u524D\u4EC5\u8C37\u6B4C\u6D4F\u89C8\u5668\u652F\u6301\uFF09 ",1)]),_:1},8,["label"])]),_:1},8,["disabled","modelValue"])])]),Io,l("ul",Co,[l("li",Ao,[d(h,{modelValue:c(n).themeMode,"onUpdate:modelValue":o[7]||(o[7]=f=>c(n).themeMode=f),placeholder:"\u4E3B\u9898\u6A21\u5F0F",onChange:a},{default:g(()=>[d(p,{label:"\u81EA\u52A8\u8BBE\u7F6E",value:"auto"}),d(p,{label:"\u6697\u591C\u4E3B\u9898",value:"dark"}),d(p,{label:"\u767D\u663C\u4E3B\u9898",value:"light"})]),_:1},8,["modelValue"])])]),c(n).themeMode==="auto"?(m(),C("div",bo," \u8BBE\u7F6E\u767D\u663C\u6A21\u5F0F\u65F6\u95F4\u533A\u95F4\uFF1A ")):D("",!0),c(n).themeMode==="auto"?(m(),C("ul",So,[l("li",yo,[d(S,{ref:"form"},{default:g(()=>[d(b,null,{default:g(()=>[d(E,{modelValue:c(n).autoLightThemeTime[0],"onUpdate:modelValue":o[8]||(o[8]=f=>c(n).autoLightThemeTime[0]=f),start:"00:00",step:"00:30",end:"23:59",onChange:a},null,8,["modelValue"]),$o,d(E,{modelValue:c(n).autoLightThemeTime[1],"onUpdate:modelValue":o[9]||(o[9]=f=>c(n).autoLightThemeTime[1]=f),start:c(n).autoLightThemeTime[0],step:"00:30",end:"23:59",onChange:a},null,8,["modelValue","start"])]),_:1})]),_:1},512)])])):D("",!0)])}}});var ko=j(wo,[["__scopeId","data-v-38b000ea"]]);const Fe=" | PicX \u56FE\u5E8A\u795E\u5668",Lo=[{path:"/",name:"index",redirect:{name:"upload"}},{path:"/config",name:"config",component:Qn,meta:{title:`\u56FE\u5E8A\u914D\u7F6E${Fe}`}},{path:"/upload",name:"upload",component:da,meta:{title:`\u56FE\u7247\u4E0A\u4F20${Fe}`}},{path:"/management",name:"Management",component:Ra,meta:{title:`\u56FE\u5E8A\u7BA1\u7406${Fe}`}},{path:"/tutorials",name:"tutorials",component:uo,meta:{title:`\u4F7F\u7528\u6559\u7A0B${Fe}`}},{path:"/about",name:"about",component:()=>ft(()=>import("./about.cb56fa21.js"),["assets/about.cb56fa21.js","assets/about.8b9cf834.css","assets/vendor.2c0a8b00.js","assets/vendor.584a67e0.css"]),meta:{title:`\u5E2E\u52A9\u53CD\u9988${Fe}`}},{path:"/settings",name:"settings",component:ko,meta:{title:`\u6211\u7684\u8BBE\u7F6E${Fe}`}}],Vt=vn({history:Fn(),routes:Lo});Vt.beforeEach((e,n,s)=>{e.meta.title&&(window.document.title=e.meta.title),s()});const Uo=e=>(ue("data-v-56a77182"),e=e(),ie(),e),Bo={class:"nav"},To={class:"nav-list"},Oo=["onClick"],Mo={class:"nav-content"},xo={class:"nav-name"},Ro={class:"nav-content"},Po=Uo(()=>l("span",{class:"nav-name"},"\u5FEB\u6377\u64CD\u4F5C",-1)),Vo={class:"quick-actions-box"},No=z({__name:"nav-content",setup(e){const n=De(),s=X(),t=$(()=>s.getters.getUserConfigInfo).value,a=$(()=>s.getters.getUserSettings).value,u=$(()=>{switch(a.elementPlusSize){case"small":return 22;case"large":return 30;default:return 26}}),o=B(a.themeMode==="dark"),i=B([{name:"\u56FE\u5E8A\u914D\u7F6E",icon:"edit",isActive:!1,path:"/config",isShow:!0},{name:"\u4E0A\u4F20\u56FE\u7247",icon:"upload",isActive:!1,path:"/upload",isShow:!0},{name:"\u56FE\u5E8A\u7BA1\u7406",icon:"box",isActive:!1,path:"/management",isShow:!0},{name:"\u6211\u7684\u8BBE\u7F6E",icon:"setting",isActive:!1,path:"/settings",isShow:!0},{name:"\u4F7F\u7528\u6559\u7A0B",icon:"magic-stick",isActive:!1,path:"/tutorials",isShow:!0},{name:"\u5E2E\u52A9\u53CD\u9988",icon:"chat-dot-round",isActive:!1,path:"/about",isShow:!0}]),r=B(!1),p=E=>{const{path:b}=E;if(b==="/management"){if(t.selectedRepos===""){x.warning("\u8BF7\u9009\u62E9\u4E00\u4E2A\u4ED3\u5E93\uFF01"),n.push("/config");return}if(t.selectedDir===""){x.warning("\u76EE\u5F55\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),n.push("/config");return}}n.push(b)},h=E=>{i.value.forEach(b=>{const S=b;return S.isActive=b.path===E,S})},_=()=>{s.dispatch("USER_SETTINGS_PERSIST")},v=()=>{a.themeMode==="dark"?a.themeMode="light":a.themeMode="dark",_()};return W(()=>n.currentRoute.value,E=>{h(E.path)}),W(()=>t.loggingStatus,E=>{i.value.forEach(b=>{switch(b.path){case"/management":case"/settings":b.isShow=E}})},{deep:!0,immediate:!0}),te(()=>{var E,b;n.isReady().then(()=>{h(n.currentRoute.value.path)}),(E=document.querySelector(".quick-actions .quick-actions-box"))==null||E.addEventListener("click",S=>{r.value=!0,S.stopPropagation()}),(b=document.querySelector(".quick-actions"))==null||b.addEventListener("click",S=>{r.value=!r.value,S.stopPropagation()}),document.addEventListener("click",()=>{r.value&&(r.value=!1)})}),(E,b)=>{const S=fe,f=H("Operation"),A=pt;return m(),C("aside",Bo,[l("ul",To,[(m(!0),C(_e,null,me(i.value,(I,N)=>q((m(),C("li",{class:le(["nav-item flex-center",{active:I.isActive}]),key:N,onClick:ae=>p(I)},[l("div",Mo,[d(S,{size:c(u)},{default:g(()=>[(m(),w(Dn(I.icon)))]),_:2},1032,["size"]),l("span",xo,G(I.name),1)])],10,Oo)),[[he,I.isShow]])),128))]),l("div",{class:le(["nav-item quick-actions flex-center",{active:r.value}])},[l("div",Ro,[d(S,{size:c(u)},{default:g(()=>[d(f)]),_:1},8,["size"]),Po]),q(l("div",Vo,[d(A,{modelValue:o.value,"onUpdate:modelValue":b[0]||(b[0]=I=>o.value=I),class:"mb-2","active-text":"\u6697\u591C\u6A21\u5F0F",onChange:v},null,8,["modelValue"]),d(A,{modelValue:c(a).isCompress,"onUpdate:modelValue":b[1]||(b[1]=I=>c(a).isCompress=I),class:"mb-2","active-text":"\u538B\u7F29\u56FE\u7247",onChange:_},null,8,["modelValue"]),d(A,{modelValue:c(a).defaultMarkdown,"onUpdate:modelValue":b[2]||(b[2]=I=>c(a).defaultMarkdown=I),class:"mb-2","active-text":"\u8F6C\u6362 Markdown",onChange:_},null,8,["modelValue"])],512),[[he,r.value]])],2)])}}});var Nt=j(No,[["__scopeId","data-v-56a77182"]]);const zo=z({name:"site-count",props:{isuv:{type:Boolean,default:!1}},setup(e,n){const s=B(null),t=B(!1),a=(u,o)=>u.querySelector(`.${o?"u":"p"}v`).innerText;return te(()=>{const u=document.createElement("script");u.async=!0,u.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",s.value.appendChild(u),u.onload=()=>{const o=setTimeout(()=>{a(s.value,e.isuv)&&(t.value=!0),clearTimeout(o)},1500)}}),{siteCountDom:s,isShow:t}}}),Go={class:"site-count",ref:"siteCountDom"},jo={id:"busuanzi_value_site_uv",class:"uv"},Ho={id:"busuanzi_value_site_pv",class:"pv"};function Xo(e,n,s,t,a,u){return q((m(),C("span",Go,[T(" \u8D85\u8FC7 "),q(l("span",jo,null,512),[[he,e.isuv]]),q(l("span",Ho,null,512),[[he,!e.isuv]]),T(" \u6B21\u88AB\u4F7F\u7528 ")],512)),[[he,e.isShow]])}var zt=j(zo,[["render",Xo]]),Yo="./assets/logo.206d082d.png";const Jo=z({name:"header-content",components:{siteCount:zt},setup(){const e=De(),n=X(),s=we({defaultUsername:"\u672A\u767B\u5F55",userConfigInfo:$(()=>n.state.userConfigInfoModule.userConfigInfo)}),t=()=>{!s.userConfigInfo.loggingStatus&&e.currentRoute.value.path!=="/config"&&e.push("/config")},a=()=>{n.dispatch("LOGOUT"),e.push("/config")},u=i=>{switch(i){case"upload":e.push("/");break;case"config":e.push("/config");break;case"management":e.push("/management");break;case"logout":a();break}},o=()=>{window.open("https://github.com/XPoet/picx")};return Ve(de({},ke(s)),{router:e,onUserInfoClick:t,handleCommand:u,goGitHubRepo:o})}}),Gt=e=>(ue("data-v-23f79e85"),e=e(),ie(),e),qo={class:"header"},Ko={class:"header-left"},Wo=Gt(()=>l("div",{class:"logo"},[l("img",{src:Yo,alt:"PicX"})],-1)),Qo=Gt(()=>l("div",{class:"title"},"PicX",-1)),Zo=[Wo,Qo],eu={class:"header-right"},tu={class:"username"},nu={key:0,class:"avatar"},su={class:"el-dropdown-link"},au={class:"avatar"},ou=["src","alt"];function uu(e,n,s,t,a,u){var E,b;const o=zt,i=pe,r=H("UserFilled"),p=fe,h=it,_=lt,v=rt;return m(),C("header",qo,[l("div",Ko,[l("div",{class:"brand",onClick:n[0]||(n[0]=S=>e.router.push("/"))},Zo),l("div",{class:"website-count",onClick:n[1]||(n[1]=(...S)=>e.goGitHubRepo&&e.goGitHubRepo(...S))},[d(i,{content:"\u611F\u89C9\u597D\u7528\uFF0C\u70B9 Star \u652F\u6301\u4F5C\u8005(*\uFFE3\uFE36\uFFE3)",placement:"bottom"},{default:g(()=>[d(o,{isuv:!1})]),_:1})])]),l("div",eu,[l("div",{class:"user-info",onClick:n[2]||(n[2]=(...S)=>e.onUserInfoClick&&e.onUserInfoClick(...S))},[l("div",tu,G(e.userConfigInfo.owner?e.userConfigInfo.owner:e.defaultUsername),1),((E=e.userConfigInfo)==null?void 0:E.avatarUrl)?D("",!0):(m(),C("div",nu,[d(p,{size:22},{default:g(()=>[d(r)]),_:1})])),((b=e.userConfigInfo)==null?void 0:b.avatarUrl)?(m(),w(v,{key:1,trigger:"click",onCommand:e.handleCommand},{dropdown:g(()=>[d(_,null,{default:g(()=>[d(h,{command:"logout"},{default:g(()=>[T(" \u9000\u51FA\u767B\u5F55 ")]),_:1})]),_:1})]),default:g(()=>{var S,f;return[l("span",su,[l("span",au,[l("img",{src:(S=e.userConfigInfo)==null?void 0:S.avatarUrl,alt:(f=e.userConfigInfo)==null?void 0:f.owner},null,8,ou)])])]}),_:1},8,["onCommand"])):D("",!0)])])])}var jt=j(Jo,[["render",uu],["__scopeId","data-v-23f79e85"]]);const Ht=()=>{const e=X(),n=async a=>{await ut(()=>{const u=document.getElementsByTagName("html")[0];a==="dark"?(u.classList.remove("light"),u.classList.add("dark")):(u.classList.remove("dark"),u.classList.add("light"))})},s=a=>{const u=i=>{const r=new Date,p=r.getFullYear(),h=r.getMonth()+1,_=r.getDate();return new Date(`${p}/${h}/${_} ${a[i]}:00`).getTime()},o=Date.now();return u(0)<=o&&o<=u(1)},t=a=>{const{themeMode:u,autoLightThemeTime:o}=a;n(u==="auto"?s(o)?"light":"dark":u)};W(()=>e.getters.getUserSettings,a=>{t(a)},{deep:!0,immediate:!0})};const iu=z({name:"main-container",components:{headerContent:jt,navContent:Nt},setup(){const e=X(),n=s=>{e.commit("CHANGE_UPLOAD_AREA_ACTIVE",s.target.classList.contains("active-upload"))};return te(()=>{Ht()}),{changeUploadAreaActive:n}}}),lu={class:"top-container"},ru={class:"bottom-container"},cu={class:"bottom-content"},du={class:"left"},pu={class:"right"},_u={class:"content"};function mu(e,n,s,t,a,u){const o=jt,i=Nt,r=H("router-view");return m(),C("main",{class:"main-container",onClick:n[0]||(n[0]=(...p)=>e.changeUploadAreaActive&&e.changeUploadAreaActive(...p))},[l("div",lu,[d(o)]),l("div",ru,[l("div",cu,[l("div",du,[d(i)]),l("div",pu,[l("div",_u,[d(r)])])])])])}var Xt=j(iu,[["render",mu],["__scopeId","data-v-6f4aaa19"]]);const fu=z({name:"App",components:{ElConfigProvider:_t,mainContainer:Xt},setup(){const e=X(),n=we({zIndex:3e3,size:"small",locale:In}),s=t=>{t<=600?(e.dispatch("SET_USER_SETTINGS",{elementPlusSize:"small"}),n.size="small"):t<=800?(e.dispatch("SET_USER_SETTINGS",{elementPlusSize:"default"}),n.size="default"):(e.dispatch("SET_USER_SETTINGS",{elementPlusSize:"large"}),n.size="large")};return te(()=>{Ht(),s(window.innerWidth),window.addEventListener("resize",t=>{s(t.target.innerWidth)})}),de({},ke(n))}});function gu(e,n,s,t,a,u){const o=Xt,i=_t;return m(),w(i,{size:e.size,"z-index":e.zIndex,locale:e.locale},{default:g(()=>[d(o)]),_:1},8,["size","z-index","locale"])}var hu=j(fu,[["render",gu]]);ft(()=>import("./register-sw.215decb5.js"),[]);const Yt=Cn(hu);for(const[e,n]of Object.entries(An))Yt.component(e,n);Yt.use(Vt).use(R,At).mount("#app");export{j as _};
